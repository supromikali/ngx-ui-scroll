{"version":3,"file":"ngx-ui-scroll.umd.js","sources":["../../node_modules/tslib/tslib.es6.js","../package/src/component/utils/checkDatasource.ts","../package/src/component/utils/assignSettings.ts","../package/src/component/interfaces/direction.ts","../package/src/component/interfaces/process.ts","../package/src/component/classes/adapter.ts","../package/src/component/classes/datasource.ts","../package/src/component/classes/settings.ts","../package/src/component/classes/logger.ts","../package/src/component/classes/domRoutines.ts","../package/src/component/classes/paddings.ts","../package/src/component/classes/viewport.ts","../package/src/component/classes/cache.ts","../package/src/component/classes/buffer.ts","../package/src/component/classes/fetch.ts","../package/src/component/classes/state.ts","../package/src/component/scroller.ts","../package/src/component/processes/init.ts","../package/src/component/processes/scroll.ts","../package/src/component/processes/reload.ts","../package/src/component/processes/start.ts","../package/src/component/processes/preFetch.ts","../package/src/component/processes/fetch.ts","../package/src/component/classes/item.ts","../package/src/component/processes/postFetch.ts","../package/src/component/processes/render.ts","../package/src/component/processes/adjust.ts","../package/src/component/processes/clip.ts","../package/src/component/processes/end.ts","../package/src/component/workflow.ts","../package/src/ui-scroll.component.ts","../package/src/ui-scroll.version.ts","../package/src/ui-scroll.directive.ts","../package/src/ui-scroll.module.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { Datasource as IDatasource } from '../interfaces/index';\n\nexport const checkDatasource = (datasource: IDatasource) => {\n  if (!datasource) {\n    throw new Error('No datasource provided');\n  }\n  if (!('get' in datasource)) {\n    throw new Error('Datasource get method is not implemented');\n  }\n  if (typeof datasource.get !== 'function') {\n    throw new Error('Datasource get is not a function');\n  }\n  if ((<Function>(datasource.get)).length < 2) {\n    throw new Error('Datasource get method invalid signature');\n  }\n  return datasource;\n};\n","import { Settings as _ISettings, DevSettings as _IDevSettings } from '../interfaces/index';\r\nimport { Settings } from '../classes/settings';\r\n\r\ntype ISettings = _ISettings | _IDevSettings;\r\n\r\nconst assignBoolean = (\r\n  target: Settings, source: ISettings, token: string, defaults: ISettings\r\n) => {\r\n  const param = (<any>source)[token];\r\n  if (typeof param === 'undefined') {\r\n    return;\r\n  }\r\n  if (typeof param !== 'boolean') {\r\n    console.warn(token + ' setting parse error, set it to ' + (<any>defaults)[token] + ' (default)');\r\n    return;\r\n  }\r\n  (<any>target)[token] = param;\r\n  return true;\r\n};\r\n\r\nconst assignNumeric = (\r\n  target: Settings, source: ISettings, token: string, defaults: ISettings, integer = false\r\n) => {\r\n  const param = (<any>source)[token];\r\n  if (typeof param === 'undefined') {\r\n    return;\r\n  }\r\n  if (typeof param !== 'number') {\r\n    console.warn(token + ' setting parse error, set it to ' + (<any>defaults)[token] + ' (default)');\r\n    return;\r\n  }\r\n  if (integer && parseInt(param.toString(), 10) !== param) {\r\n    console.warn(token + ' setting parse error, set it to ' + (<any>defaults)[token] + ' (default)');\r\n    return;\r\n  }\r\n  (<any>target)[token] = param;\r\n  return true;\r\n};\r\n\r\nconst assignMinimalNumeric = (\r\n  target: Settings,\r\n  source: ISettings,\r\n  token: string,\r\n  defaults: ISettings,\r\n  minSettings: ISettings,\r\n  integer = false,\r\n  mustExist = true\r\n) => {\r\n  if (assignNumeric(target, source, token, defaults, integer) !== true) {\r\n    if (!mustExist) {\r\n      return;\r\n    }\r\n  }\r\n  if ((<any>target)[token] < (<any>minSettings)[token]) {\r\n    console.warn(token + ' setting is less than minimum, set it to ' + (<any>minSettings)[token]);\r\n    (<any>target)[token] = (<any>minSettings)[token];\r\n    return;\r\n  }\r\n  return true;\r\n};\r\n\r\nconst assignCommon = (target: Settings, settings: ISettings, defaults: ISettings) => {\r\n  Object.assign(target, defaults);\r\n  if (typeof settings === 'undefined') {\r\n    return;\r\n  }\r\n  if (typeof settings !== 'object') {\r\n    console.warn('settings is not an object, fallback to the defaults');\r\n    return;\r\n  }\r\n};\r\n\r\nexport const assignSettings = (\r\n  target: Settings, settings: _ISettings, defaults: _ISettings, minSettings: _ISettings\r\n) => {\r\n  assignCommon(target, settings, defaults);\r\n  assignBoolean(target, settings, 'adapter', defaults);\r\n  assignNumeric(target, settings, 'startIndex', defaults);\r\n  assignNumeric(target, settings, 'minIndex', defaults);\r\n  assignNumeric(target, settings, 'maxIndex', defaults);\r\n  assignMinimalNumeric(target, settings, 'itemSize', defaults, minSettings, true, false);\r\n  assignMinimalNumeric(target, settings, 'bufferSize', defaults, minSettings, true);\r\n  assignMinimalNumeric(target, settings, 'padding', defaults, minSettings);\r\n  assignBoolean(target, settings, 'infinite', defaults);\r\n  assignBoolean(target, settings, 'horizontal', defaults);\r\n  assignBoolean(target, settings, 'windowViewport', defaults);\r\n};\r\n\r\nexport const assignDevSettings = (\r\n  target: Settings, devSettings: _IDevSettings, defaults: _IDevSettings, minDevSettings: _IDevSettings\r\n) => {\r\n  assignCommon(target, devSettings, defaults);\r\n  assignBoolean(target, devSettings, 'debug', defaults);\r\n  assignBoolean(target, devSettings, 'immediateLog', defaults);\r\n  assignBoolean(target, devSettings, 'logTime', defaults);\r\n  assignMinimalNumeric(target, devSettings, 'throttle', defaults, minDevSettings, true);\r\n  assignBoolean(target, devSettings, 'inertia', defaults);\r\n  assignMinimalNumeric(target, devSettings, 'inertiaScrollDelay', defaults, minDevSettings, true);\r\n  assignMinimalNumeric(target, devSettings, 'inertiaScrollDelta', defaults, minDevSettings, true);\r\n  assignMinimalNumeric(target, devSettings, 'initDelay', defaults, minDevSettings, true);\r\n  assignMinimalNumeric(target, devSettings, 'initWindowDelay', defaults, minDevSettings, true);\r\n  assignMinimalNumeric(target, devSettings, 'maxSynthScrollDelay', defaults, minDevSettings, true);\r\n};\r\n","export enum Direction {\n  forward = 'forward',\n  backward = 'backward'\n}\n","export enum Process {\r\n  init = 'init',\r\n  scroll = 'scroll',\r\n  reload = 'reload',\r\n  start = 'start',\r\n  preFetch = 'preFetch',\r\n  fetch = 'fetch',\r\n  postFetch = 'postFetch',\r\n  render = 'render',\r\n  clip = 'clip',\r\n  adjust = 'adjust',\r\n  end = 'end'\r\n}\r\n\r\nexport enum ProcessStatus {\r\n  start = 'start',\r\n  next = 'next',\r\n  done = 'done',\r\n  error = 'error'\r\n}\r\n\r\nexport interface ScrollPayload {\r\n  event?: Event;\r\n  byTimer?: boolean;\r\n}\r\n\r\nexport interface ProcessRun {\r\n  empty?: boolean;\r\n  scroll?: boolean;\r\n  keepScroll?: boolean;\r\n  byTimer?: boolean;\r\n  error?: string;\r\n}\r\n\r\nexport interface ProcessSubject {\r\n  process: Process;\r\n  status: ProcessStatus;\r\n  payload?: ProcessRun;\r\n}\r\n\r\nexport type CallWorkflow = (processSubject: ProcessSubject) => undefined;\r\n","import { BehaviorSubject, Observable, Observer, of as observableOf } from 'rxjs';\r\nimport { switchMap } from 'rxjs/operators';\r\n\r\nimport { Adapter as IAdapter, Process, ProcessSubject, ProcessStatus, ItemAdapter } from '../interfaces/index';\r\nimport { Scroller } from '../scroller';\r\n\r\nconst getIsInitialized = (adapter: Adapter): Observable<boolean> =>\r\n  Observable.create((observer: Observer<boolean>) => {\r\n    const intervalId = setInterval(() => {\r\n      if (adapter && adapter.init) {\r\n        clearInterval(intervalId);\r\n        observer.next(true);\r\n        observer.complete();\r\n      }\r\n    }, 25);\r\n  });\r\n\r\nconst getInitializedSubject = (adapter: Adapter, method: Function): BehaviorSubject<any> => {\r\n  return adapter.init ? method() :\r\n    adapter.init$\r\n      .pipe(switchMap(() =>\r\n        method()\r\n      ));\r\n};\r\n\r\nexport const itemAdapterEmpty = <ItemAdapter> {\r\n  data: {},\r\n  element: {}\r\n};\r\n\r\nexport const generateMockAdapter = (): IAdapter => (\r\n  <IAdapter> {\r\n    version: null,\r\n    init: false,\r\n    init$: observableOf(false),\r\n    isLoading: false,\r\n    isLoading$: new BehaviorSubject<boolean>(false),\r\n    cyclePending: false,\r\n    cyclePending$: new BehaviorSubject<boolean>(false),\r\n    loopPending: false,\r\n    loopPending$: new BehaviorSubject<boolean>(false),\r\n    firstVisible: itemAdapterEmpty,\r\n    firstVisible$: new BehaviorSubject<ItemAdapter>(itemAdapterEmpty),\r\n    lastVisible: itemAdapterEmpty,\r\n    lastVisible$: new BehaviorSubject<ItemAdapter>(itemAdapterEmpty),\r\n    itemsCount: 0,\r\n    initialize: () => null,\r\n    reload: () => null,\r\n    showLog: () => null,\r\n    setMinIndex: () => null,\r\n    setScrollPosition: () => null\r\n  }\r\n);\r\n\r\nexport class Adapter implements IAdapter {\r\n\r\n  get init(): boolean {\r\n    return this.isInitialized;\r\n  }\r\n\r\n  get init$(): Observable<boolean> {\r\n    return getIsInitialized(this);\r\n  }\r\n\r\n  get version(): string | null {\r\n    return this.isInitialized ? this.getVersion() : null;\r\n  }\r\n\r\n  get isLoading(): boolean {\r\n    return this.isInitialized ? this.getIsLoading() : false;\r\n  }\r\n\r\n  get isLoading$(): BehaviorSubject<boolean> {\r\n    return getInitializedSubject(this, () => this.getIsLoading$());\r\n  }\r\n\r\n  get loopPending(): boolean {\r\n    return this.isInitialized ? this.getLoopPending() : false;\r\n  }\r\n\r\n  get loopPending$(): BehaviorSubject<boolean> {\r\n    return getInitializedSubject(this, () => this.getLoopPending$());\r\n  }\r\n\r\n  get cyclePending(): boolean {\r\n    return this.isInitialized ? this.getCyclePending() : false;\r\n  }\r\n\r\n  get cyclePending$(): BehaviorSubject<boolean> {\r\n    return getInitializedSubject(this, () => this.getCyclePending$());\r\n  }\r\n\r\n  get firstVisible(): ItemAdapter {\r\n    return this.isInitialized ? this.getFirstVisible() : {};\r\n  }\r\n\r\n  get firstVisible$(): BehaviorSubject<ItemAdapter> {\r\n    return getInitializedSubject(this, () => this.getFirstVisible$());\r\n  }\r\n\r\n  get lastVisible(): ItemAdapter {\r\n    return this.isInitialized ? this.getLastVisible() : {};\r\n  }\r\n\r\n  get lastVisible$(): BehaviorSubject<ItemAdapter> {\r\n    return getInitializedSubject(this, () => this.getLastVisible$());\r\n  }\r\n\r\n  get itemsCount(): number {\r\n    return this.isInitialized ? this.getItemsCount() : 0;\r\n  }\r\n\r\n  private scroller: Scroller;\r\n  private isInitialized: boolean;\r\n  private callWorkflow: Function;\r\n  private getVersion: Function;\r\n  private getIsLoading: Function;\r\n  private getIsLoading$: Function;\r\n  private getCyclePending: Function;\r\n  private getCyclePending$: Function;\r\n  private getLoopPending: Function;\r\n  private getLoopPending$: Function;\r\n  private getItemsCount: Function;\r\n  private getFirstVisible: Function;\r\n  private getFirstVisible$: Function;\r\n  private getLastVisible: Function;\r\n  private getLastVisible$: Function;\r\n\r\n  constructor() {\r\n    this.isInitialized = false;\r\n  }\r\n\r\n  initialize(scroller: Scroller) {\r\n    if (this.isInitialized) {\r\n      return;\r\n    }\r\n    this.scroller = scroller;\r\n    const { state, buffer } = scroller;\r\n    this.isInitialized = true;\r\n    this.callWorkflow = scroller.callWorkflow;\r\n    this.getVersion = (): string | null => scroller.version;\r\n    this.getIsLoading = (): boolean => state.isLoading;\r\n    this.getIsLoading$ = (): BehaviorSubject<boolean> => state.isLoadingSource;\r\n    this.getLoopPending = (): boolean => state.loopPending;\r\n    this.getLoopPending$ = (): BehaviorSubject<boolean> => state.loopPendingSource;\r\n    this.getCyclePending = (): boolean => state.workflowPending;\r\n    this.getCyclePending$ = (): BehaviorSubject<boolean> => state.workflowPendingSource;\r\n    this.getItemsCount = (): number => buffer.getVisibleItemsCount();\r\n    this.initializeProtected(scroller);\r\n  }\r\n\r\n  initializeProtected(scroller: Scroller) {\r\n    const { state } = scroller;\r\n    let getFirstVisibleProtected = () => {\r\n      getFirstVisibleProtected = () => state.firstVisibleItem;\r\n      state.firstVisibleWanted = true;\r\n      return state.firstVisibleItem;\r\n    };\r\n    let getFirstVisible$Protected = () => {\r\n      getFirstVisible$Protected = () => state.firstVisibleSource;\r\n      state.firstVisibleWanted = true;\r\n      return state.firstVisibleSource;\r\n    };\r\n    let getLastVisibleProtected = () => {\r\n      getLastVisibleProtected = () => state.lastVisibleItem;\r\n      state.lastVisibleWanted = true;\r\n      return state.lastVisibleItem;\r\n    };\r\n    let getLastVisible$Protected = () => {\r\n      getLastVisible$Protected = () => state.lastVisibleSource;\r\n      state.lastVisibleWanted = true;\r\n      return state.lastVisibleSource;\r\n    };\r\n    this.getFirstVisible = (): ItemAdapter => getFirstVisibleProtected();\r\n    this.getFirstVisible$ = (): BehaviorSubject<ItemAdapter> => getFirstVisible$Protected();\r\n    this.getLastVisible = (): ItemAdapter => getLastVisibleProtected();\r\n    this.getLastVisible$ = (): BehaviorSubject<ItemAdapter> => getLastVisible$Protected();\r\n  }\r\n\r\n  reload(reloadIndex?: number | string) {\r\n    this.scroller.logger.log(() => `adapter: reload(${reloadIndex})`);\r\n    this.callWorkflow(<ProcessSubject>{\r\n      process: Process.reload,\r\n      status: ProcessStatus.start,\r\n      payload: reloadIndex\r\n    });\r\n  }\r\n\r\n  showLog() {\r\n    this.scroller.logger.logForce();\r\n  }\r\n\r\n  setScrollPosition(value: number) {\r\n    this.scroller.logger.log(() => `adapter: setScrollPosition(${value})`);\r\n    const position = Number(value);\r\n    const parsedValue = parseInt(<any>value, 10);\r\n    if (position !== parsedValue) {\r\n      this.scroller.logger.log(() =>\r\n        `can't set scroll position because ${value} is not an integer`);\r\n    } else {\r\n      this.scroller.state.syntheticScroll.reset();\r\n      this.scroller.viewport.setPosition(value);\r\n    }\r\n  }\r\n\r\n  setMinIndex(value: number) {\r\n    this.scroller.logger.log(() => `adapter: setMinIndex(${value})`);\r\n    const index = Number(value);\r\n    if (isNaN(index)) {\r\n      this.scroller.logger.log(() =>\r\n        `can't set minIndex because ${value} is not a number`);\r\n    } else {\r\n      this.scroller.buffer.minIndexUser = index;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Datasource as IDatasource, DatasourceGet, DevSettings, Settings, Adapter as IAdapter\r\n} from '../interfaces/index';\r\nimport { Adapter, generateMockAdapter } from './adapter';\r\n\r\nexport class Datasource implements IDatasource {\r\n  readonly constructed: boolean;\r\n  get: DatasourceGet;\r\n  settings?: Settings;\r\n  devSettings?: DevSettings;\r\n  adapter: IAdapter;\r\n\r\n  constructor(datasource: IDatasource, hasNoAdapter?: boolean) {\r\n    this.constructed = true;\r\n    Object.assign(<any>this, datasource);\r\n    if (hasNoAdapter) {\r\n      this.adapter = <IAdapter>generateMockAdapter();\r\n    } else {\r\n      this.adapter = new Adapter();\r\n    }\r\n  }\r\n}\r\n","import { Settings as ISettings, DevSettings as IDevSettings } from '../interfaces/index';\nimport { assignSettings, assignDevSettings } from '../utils/index';\n\nexport const defaultSettings: ISettings = {\n  adapter: false,\n  startIndex: 1,\n  minIndex: -Infinity,\n  maxIndex: Infinity,\n  bufferSize: 5,\n  padding: 0.5,\n  infinite: false,\n  horizontal: false,\n  windowViewport: false\n};\n\nexport const minSettings: ISettings = {\n  itemSize: 1,\n  bufferSize: 1,\n  padding: 0.01\n};\n\nexport const defaultDevSettings: IDevSettings = {\n  debug: false, // if true, logging is enabled; need to turn off when release\n  immediateLog: true, // if false, logging is not immediate and could be done via Workflow.logForce call\n  logTime: false, // if true, time differences are being logged\n  throttle: 40, // if > 0, scroll event handling is throttled (ms)\n  inertia: false, // if true, inertia scroll delay (ms) and delta (px) are taken into the account\n  inertiaScrollDelay: 125,\n  inertiaScrollDelta: 35,\n  initDelay: 1, // if set, the Workflow initialization will be postponed (ms)\n  initWindowDelay: 40, // if set and the entire window is scrollable, the Workflow init will be postponed (ms)\n  maxSynthScrollDelay: 450 // if > 0, synthetic scroll params will be reset after [value] (ms)\n};\n\nexport const minDevSettings: IDevSettings = {\n  throttle: 0,\n  inertiaScrollDelay: 0,\n  inertiaScrollDelta: 0,\n  initDelay: 0,\n  initWindowDelay: 0,\n  maxSynthScrollDelay: 0\n};\n\nexport class Settings implements ISettings {\n\n  // user settings\n  adapter: boolean;\n  startIndex: number;\n  minIndex: number;\n  maxIndex: number;\n  itemSize: number;\n  bufferSize: number;\n  padding: number;\n  infinite: boolean;\n  horizontal: boolean;\n  windowViewport: boolean;\n\n  // development settings\n  debug: boolean;\n  immediateLog: boolean;\n  logTime: boolean;\n  throttle: number;\n  inertia: boolean;\n  inertiaScrollDelay: number;\n  inertiaScrollDelta: number;\n  initDelay: number;\n  initWindowDelay: number;\n  maxSynthScrollDelay: number;\n\n  // internal settings, managed by scroller itself\n  instanceIndex: number;\n  initializeDelay: number;\n\n  constructor(\n    settings: ISettings | undefined, devSettings: IDevSettings | undefined, instanceIndex: number\n  ) {\n    assignSettings(this, settings || {}, defaultSettings, minSettings);\n    assignDevSettings(this, devSettings || {}, defaultDevSettings, minDevSettings);\n    this.instanceIndex = instanceIndex;\n    this.initializeDelay = this.getInitializeDelay();\n    // todo: min/max indexes must be ignored if infinite mode is enabled ??\n  }\n\n  getInitializeDelay(): number {\n    let result = 0;\n    if (this.windowViewport && this.initWindowDelay && !('scrollRestoration' in history)) {\n      result = this.initWindowDelay;\n    }\n    if (this.initDelay > 0) {\n      result = Math.max(result, this.initDelay);\n    }\n    return result;\n  }\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessRun, ProcessStatus as Status, ProcessSubject } from '../interfaces/index';\n\nexport class Logger {\n\n  readonly debug: boolean;\n  readonly immediateLog: boolean;\n  readonly logTime: boolean;\n  readonly getTime: Function;\n  readonly getStat: Function;\n  readonly getFetchRange: Function;\n  readonly getInnerLoopCount: Function;\n  readonly getWorkflowCycleData: Function;\n  private logs: Array<any> = [];\n\n  constructor(scroller: Scroller) {\n    const { settings } = scroller;\n    this.debug = settings.debug;\n    this.immediateLog = settings.immediateLog;\n    this.logTime = settings.logTime;\n    this.getTime = (): string =>\n      scroller.state && ` // time: ${scroller.state.time}`;\n    this.getStat = (): string => {\n      const { buffer, viewport } = scroller;\n      const first = buffer.getFirstVisibleItem();\n      const last = buffer.getLastVisibleItem();\n      return 'pos: ' + viewport.scrollPosition + ', ' +\n        'size: ' + viewport.getScrollableSize() + ', ' +\n        'bwd_p: ' + viewport.paddings.backward.size + ', ' +\n        'fwd_p: ' + viewport.paddings.forward.size + ', ' +\n        'aver: ' + (buffer.hasItemSize ? buffer.averageSize : 'no') + ', ' +\n        'items: ' + buffer.getVisibleItemsCount() + ', ' +\n        'range: ' + (first && last ? `[${first.$index}..${last.$index}]` : 'no');\n    };\n    this.getFetchRange = (): string => {\n      const { firstIndex, lastIndex } = scroller.state.fetch;\n      const hasInterval = firstIndex !== null && lastIndex !== null && !isNaN(firstIndex) && !isNaN(lastIndex);\n      return hasInterval ? `[${firstIndex}..${lastIndex}]` : 'no';\n    };\n    this.getInnerLoopCount = (): number => scroller.state.innerLoopCount;\n    this.getWorkflowCycleData = (more: boolean): string =>\n      `${scroller.settings.instanceIndex}-${scroller.state.workflowCycleCount}` + (more ? '-' : '');\n    this.log(() => `uiScroll Workflow has been started (v${scroller.version}, instance ${settings.instanceIndex})`);\n  }\n\n  object(str: string, obj: any, stringify?: boolean) {\n    this.log(() => [\n      str,\n      stringify\n        ? JSON.stringify(obj)\n          .replace(/\"/g, '')\n          .replace(/(\\{|\\:|\\,)/g, '$1 ')\n        : obj\n    ]);\n  }\n\n  stat(str?: string) {\n    if (this.debug) {\n      const logStyles = ['color: #888; border: dashed #888 0; border-bottom-width: 0px', 'color: #000; border-width: 0'];\n      this.log(() => ['%cstat' + (str ? ` ${str}` : '') + ',%c ' + this.getStat(), ...logStyles]);\n    }\n  }\n\n  fetch(str?: string) {\n    if (this.debug) {\n      const _text = 'fetch interval' + (str ? ` ${str}` : '');\n      const logStyles = ['color: #888', 'color: #000'];\n      this.log(() => [`%c${_text}: %c${this.getFetchRange()}`, ...logStyles]);\n    }\n  }\n\n  logProcess(data: ProcessSubject) {\n    if (!this.debug) {\n      return;\n    }\n    const { process, status } = data;\n    const payload: ProcessRun = data.payload || { empty: true };\n\n    // standard process log\n    const processLog = `process ${process}, %c${status}%c` + (!payload.empty ? ',' : '');\n    const styles = [status === Status.error ? 'color: #cc0000;' : '', 'color: #000000;'];\n    this.log(() => [processLog, ...styles, ...(!payload.empty ? [payload] : [])]);\n\n    // inner loop start-end log\n    const workflowCycleData = this.getWorkflowCycleData(true);\n    const loopCount = this.getInnerLoopCount();\n    const loopLog: string[] = [];\n    if (\n      process === Process.init && status === Status.next ||\n      process === Process.scroll && status === Status.next && payload.keepScroll ||\n      process === Process.end && status === Status.next && payload.byTimer\n    ) {\n      loopLog.push(`%c---=== loop ${workflowCycleData + (loopCount + 1)} start`);\n    } else if (\n      process === Process.end && !payload.byTimer\n    ) {\n      loopLog.push(`%c---=== loop ${workflowCycleData + loopCount} done`);\n      if (status === Status.next && !(payload.keepScroll)) {\n        loopLog[0] += `, loop ${workflowCycleData + (loopCount + 1)} start`;\n      }\n    }\n    if (loopLog.length) {\n      this.log(() => [...loopLog, 'color: #006600;']);\n    }\n\n    // workflow cycle start log\n    if (\n      process === Process.init && status === Status.start ||\n      process === Process.reload && status === Status.next ||\n      process === Process.scroll && status === Status.next && !(payload.keepScroll)\n    ) {\n      const logData = this.getWorkflowCycleData(false);\n      const logStyles = 'color: #0000aa; border: solid black 1px; border-width: 1px 0 0 1px; margin-left: -2px';\n      this.log(() => [`%c   ~~~ WF Cycle ${logData} STARTED ~~~  `, logStyles]);\n    }\n\n    // workflow run end log\n    if (process === Process.end && status === Status.done) {\n      const logData = this.getWorkflowCycleData(false);\n      const logStyles = 'color: #0000aa; border: solid #555 1px; border-width: 0 0 1px 1px; margin-left: -2px';\n      this.log(() => [`%c   ~~~ WF Cycle ${logData} FINALIZED ~~~  `, logStyles]);\n    }\n  }\n\n  log(...args: Array<any>) {\n    if (this.debug) {\n      if (typeof args[0] === 'function') {\n        args = args[0]();\n        if (!Array.isArray(args)) {\n          args = [args];\n        }\n      }\n      if (args.every(item => item === undefined)) {\n        return;\n      }\n      if (this.logTime) {\n        args = [...args, this.getTime()];\n      }\n      if (this.immediateLog) {\n        console.log.apply(this, args);\n      } else {\n        this.logs.push(args);\n      }\n    }\n  }\n\n  logForce(...args: Array<any>) {\n    if (this.debug) {\n      if (!this.immediateLog && this.logs.length) {\n        this.logs.forEach(logArgs => console.log.apply(this, logArgs));\n        this.logs = [];\n      }\n      if (args.length) {\n        console.log.apply(this, args);\n      }\n    }\n  }\n}\n","import { Direction } from '../interfaces/direction';\nimport { Settings } from './settings';\n\nexport class Routines {\n\n  readonly horizontal: boolean;\n\n  constructor(settings: Settings) {\n    this.horizontal = settings.horizontal;\n  }\n\n  getScrollPosition(element: HTMLElement): number {\n    return element[this.horizontal ? 'scrollLeft' : 'scrollTop'];\n  }\n\n  setScrollPosition(element: HTMLElement, value: number) {\n    element[this.horizontal ? 'scrollLeft' : 'scrollTop'] = value;\n  }\n\n  getParams(element: HTMLElement): ClientRect {\n    if (element.tagName.toLowerCase() === 'body') {\n      element = <HTMLElement>element.parentElement;\n      return <ClientRect>{\n        'height': element.clientHeight,\n        'width': element.clientWidth,\n        'top': element.clientTop,\n        'bottom': element.clientTop + element.clientHeight,\n        'left': element.clientLeft,\n        'right': element.clientLeft + element.clientWidth\n      };\n    }\n    return element.getBoundingClientRect();\n  }\n\n  getSize(element: HTMLElement): number {\n    return this.getParams(element)[this.horizontal ? 'width' : 'height'];\n  }\n\n  getSizeStyle(element: HTMLElement): number {\n    const size = element.style[this.horizontal ? 'width' : 'height'];\n    return parseInt(<string>size, 10) || 0;\n  }\n\n  setSizeStyle(element: HTMLElement, value: number) {\n    element.style[this.horizontal ? 'width' : 'height'] = `${value}px`;\n  }\n\n  getRectEdge(params: ClientRect, direction: Direction, opposite?: boolean): number {\n    const forward = !opposite ? Direction.forward : Direction.backward;\n    return params[direction === forward ? (this.horizontal ? 'right' : 'bottom') : (this.horizontal ? 'left' : 'top')];\n  }\n\n  getEdge(element: HTMLElement, direction: Direction, opposite?: boolean): number {\n    const params = this.getParams(element);\n    return this.getRectEdge(params, direction, opposite);\n  }\n\n  getEdge2(element: HTMLElement, direction: Direction, relativeElement: HTMLElement, opposite: boolean): number {\n    // vertical only ?\n    return element.offsetTop - (relativeElement ? relativeElement.scrollTop : 0) +\n      (direction === (!opposite ? Direction.forward : Direction.backward) ? this.getSize(element) : 0);\n  }\n\n  hideElement(element: HTMLElement) {\n    element.style.display = 'none';\n  }\n\n  getOffset(element: HTMLElement): number {\n    return this.horizontal ? element.offsetLeft : element.offsetTop;\n  }\n\n}\n","import { Direction } from '../interfaces/direction';\r\nimport { Routines } from './domRoutines';\r\nimport { Settings } from './settings';\r\n\r\nexport class Padding {\r\n\r\n  element: HTMLElement;\r\n  direction: Direction;\r\n  routines: Routines;\r\n\r\n  constructor(element: HTMLElement, direction: Direction, routines: Routines) {\r\n    this.element = <HTMLElement>element.querySelector(`[data-padding-${direction}]`);\r\n    this.direction = direction;\r\n    this.routines = routines;\r\n  }\r\n\r\n  reset(size?: number) {\r\n    this.size = size || 0;\r\n  }\r\n\r\n  get size(): number {\r\n    return this.routines.getSizeStyle(this.element);\r\n  }\r\n\r\n  set size(value: number) {\r\n    this.routines.setSizeStyle(this.element, Math.round(value));\r\n  }\r\n\r\n}\r\n\r\nexport class Paddings {\r\n  settings: Settings;\r\n  forward: Padding;\r\n  backward: Padding;\r\n\r\n  constructor(element: HTMLElement, routines: Routines, settings: Settings) {\r\n    this.settings = settings;\r\n    this.forward = new Padding(element, Direction.forward, routines);\r\n    this.backward = new Padding(element, Direction.backward, routines);\r\n  }\r\n\r\n  reset(viewportSize: number, startIndex: number) {\r\n    this.forward.reset(this.getPositiveSize(startIndex, viewportSize));\r\n    this.backward.reset(this.getNegativeSize(startIndex));\r\n  }\r\n\r\n  getPositiveSize(startIndex: number, viewportSize: number) {\r\n    const { settings } = this;\r\n    let positiveSize = viewportSize;\r\n    if (isFinite(settings.maxIndex)) {\r\n      positiveSize = (settings.maxIndex - startIndex + 1) * settings.itemSize;\r\n    }\r\n    return positiveSize;\r\n  }\r\n\r\n  getNegativeSize(startIndex: number) {\r\n    const { settings } = this;\r\n    let negativeSize = 0;\r\n    if (isFinite(settings.minIndex)) {\r\n      negativeSize = (startIndex - settings.minIndex) * settings.itemSize;\r\n    }\r\n    return negativeSize;\r\n  }\r\n}\r\n","import { ElementRef } from '@angular/core';\n\nimport { Direction } from '../interfaces/index';\nimport { Paddings } from './paddings';\nimport { Settings } from './settings';\nimport { Routines } from './domRoutines';\nimport { State } from './state';\nimport { Logger } from './logger';\n\nexport class Viewport {\n\n  paddings: Paddings;\n  startDelta: number;\n\n  readonly element: HTMLElement;\n  readonly host: HTMLElement;\n  readonly scrollEventElement: HTMLElement | Document;\n  readonly scrollable: HTMLElement;\n  readonly settings: Settings;\n  readonly routines: Routines;\n  readonly state: State;\n  readonly logger: Logger;\n\n  constructor(elementRef: ElementRef, settings: Settings, routines: Routines, state: State, logger: Logger) {\n    this.settings = settings;\n    this.routines = routines;\n    this.state = state;\n    this.logger = logger;\n    this.element = elementRef.nativeElement;\n\n    if (settings.windowViewport) {\n      this.host = (<Document>this.element.ownerDocument).body;\n      this.scrollEventElement = <Document>(this.element.ownerDocument);\n      this.scrollable = <HTMLElement>this.scrollEventElement.scrollingElement;\n    } else {\n      this.host = <HTMLElement>this.element.parentElement;\n      this.scrollEventElement = this.host;\n      this.scrollable = <HTMLElement>this.element.parentElement;\n    }\n\n    this.paddings = new Paddings(this.element, this.routines, settings);\n\n    if (settings.windowViewport && 'scrollRestoration' in history) {\n      history.scrollRestoration = 'manual';\n    }\n  }\n\n  reset(scrollPosition: number) {\n    let newPosition = 0;\n    this.paddings.reset(this.getSize(), this.state.startIndex);\n    const negativeSize = this.paddings.backward.size;\n    if (negativeSize) {\n      newPosition = negativeSize;\n      this.state.bwdPaddingAverageSizeItemsCount = negativeSize / this.settings.itemSize;\n    }\n    this.scrollPosition = newPosition;\n    this.state.scrollState.reset();\n    this.state.syntheticScroll.reset(scrollPosition !== newPosition ? newPosition : null);\n    this.startDelta = 0;\n  }\n\n  setPosition(value: number, oldPosition?: number): number {\n    if (oldPosition === undefined) {\n      oldPosition = this.scrollPosition;\n    }\n    if (oldPosition === value) {\n      this.logger.log(() => ['setting scroll position at', value, '[cancelled]']);\n      return value;\n    }\n    this.routines.setScrollPosition(this.scrollable, value);\n    const position = this.scrollPosition;\n    this.logger.log(() => ['setting scroll position at', position]);\n    return position;\n  }\n\n  get scrollPosition(): number {\n    return this.routines.getScrollPosition(this.scrollable);\n  }\n\n  set scrollPosition(value: number) {\n    const oldPosition = this.scrollPosition;\n    const newPosition = this.setPosition(value, oldPosition);\n    const synthState = this.state.syntheticScroll;\n    synthState.time = Number(Date.now());\n    synthState.position = newPosition;\n    synthState.delta = newPosition - oldPosition;\n    if (synthState.positionBefore === null) {\n      // syntheticScroll.positionBefore should be set once per cycle\n      synthState.positionBefore = oldPosition;\n    }\n  }\n\n  getSize(): number {\n    return this.routines.getSize(this.host);\n  }\n\n  getScrollableSize(): number {\n    return this.routines.getSize(this.element);\n  }\n\n  getBufferPadding(): number {\n    return this.getSize() * this.settings.padding;\n  }\n\n  getEdge(direction: Direction, opposite?: boolean): number {\n    return this.routines.getEdge(this.host, direction, opposite);\n  }\n\n  getElementEdge(element: HTMLElement, direction: Direction, opposite?: boolean): number {\n    return this.routines.getEdge(element, direction, opposite);\n  }\n\n  getOffset(): number {\n    return this.routines.getOffset(this.element);\n  }\n\n}\n","import { Item } from './item';\nimport { Settings } from '../classes/settings';\nimport { Logger } from './logger';\n\nexport class ItemCache {\n  $index: number;\n  nodeId: string;\n  data: any; // todo: cache data only if it is permitted by settings\n  size: number;\n  position: number;\n\n  constructor(item: Item) {\n    this.$index = item.$index;\n    this.nodeId = item.nodeId;\n    this.data = item.data;\n    this.size = item.size;\n  }\n}\n\nexport class RecalculateAverage {\n  newItems: Array<number>;\n  oldItems: Array<number>;\n\n  constructor() {\n    this.reset();\n  }\n\n  reset() {\n    this.newItems = [];\n    this.oldItems = [];\n  }\n}\n\nexport class Cache {\n  averageSizeFloat: number;\n  averageSize: number;\n  minIndex: number;\n  maxIndex: number;\n  recalculateAverage: RecalculateAverage;\n\n  private items: Map<number, ItemCache>;\n  readonly logger: Logger;\n  readonly itemSize: number;\n\n  constructor(itemSize: number, logger: Logger) {\n    this.averageSizeFloat = itemSize;\n    this.averageSize = itemSize;\n    this.itemSize = itemSize;\n    this.items = new Map<number, ItemCache>();\n    this.recalculateAverage = new RecalculateAverage();\n    this.reset();\n    this.logger = logger;\n  }\n\n  reset() {\n    this.minIndex = +Infinity;\n    this.maxIndex = -Infinity;\n    this.items.clear();\n    this.averageSizeFloat = this.itemSize;\n    this.averageSize = this.itemSize;\n    this.recalculateAverage.reset();\n  }\n\n  recalculateAverageSize() {\n    const { oldItems: { length: oldItemsLength }, newItems: { length: newItemsLength } } = this.recalculateAverage;\n    if (!oldItemsLength && !newItemsLength) {\n      return;\n    }\n    const oldItemsSize = this.recalculateAverage.oldItems.reduce((acc, index) => acc + this.getItemSize(index), 0);\n    const newItemsSize = this.recalculateAverage.newItems.reduce((acc, index) => acc + this.getItemSize(index), 0);\n    if (oldItemsLength) {\n      const averageSize = this.averageSizeFloat || 0;\n      const averageSizeLength = this.items.size - newItemsLength - oldItemsLength;\n      this.averageSizeFloat = (averageSizeLength * averageSize + oldItemsSize) / averageSizeLength;\n    }\n    if (newItemsLength) {\n      const averageSize = this.averageSizeFloat || 0;\n      const averageSizeLength = this.items.size - newItemsLength;\n      this.averageSizeFloat = (averageSizeLength * averageSize + newItemsSize) / this.items.size;\n    }\n    this.averageSize = Math.round(this.averageSizeFloat);\n    this.recalculateAverage.reset();\n    this.logger.log(() => `average size has been updated: ${this.averageSize}`);\n  }\n\n  add(item: Item): ItemCache {\n    let itemCache = this.get(item.$index);\n    if (itemCache) {\n      itemCache.data = item.data;\n      if (itemCache.size !== item.size) {\n        itemCache.size = item.size;\n        this.recalculateAverage.oldItems.push(item.$index);\n      }\n    } else {\n      itemCache = new ItemCache(item);\n      this.items.set(item.$index, itemCache);\n      if (this.averageSize !== itemCache.size) {\n        this.recalculateAverage.newItems.push(item.$index);\n      }\n    }\n    if (item.$index < this.minIndex) {\n      this.minIndex = item.$index;\n    }\n    if (item.$index > this.maxIndex) {\n      this.maxIndex = item.$index;\n    }\n    return itemCache;\n  }\n\n  getItemSize(index: number): number {\n    const item = this.get(index);\n    return item ? item.size : 0;\n  }\n\n  get(index: number): ItemCache | undefined {\n    return this.items.get(index);\n  }\n}\n","import { BehaviorSubject } from 'rxjs';\n\nimport { Direction } from '../interfaces/index';\nimport { Cache } from './cache';\nimport { Item } from './item';\nimport { Settings } from './settings';\nimport { Logger } from './logger';\n\nexport class Buffer {\n\n  private _items: Array<Item>;\n  $items: BehaviorSubject<Array<Item>>;\n\n  pristine: boolean;\n  cache: Cache;\n  minIndexUser: number;\n  maxIndexUser: number;\n  absMinIndex: number;\n  absMaxIndex: number;\n\n  private startIndex: number;\n  readonly minBufferSize: number;\n  readonly logger: Logger;\n\n  constructor(settings: Settings, startIndex: number, logger: Logger) {\n    this.$items = new BehaviorSubject<Array<Item>>([]);\n    this.cache = new Cache(settings.itemSize, logger);\n    this.minIndexUser = settings.minIndex;\n    this.maxIndexUser = settings.maxIndex;\n    this.reset();\n    this.startIndex = startIndex;\n    this.minBufferSize = settings.bufferSize;\n    this.logger = logger;\n  }\n\n  reset(reload?: boolean, startIndex?: number) {\n    if (reload) {\n      this.items.forEach(item => item.hide());\n    }\n    this.items = [];\n    this.pristine = true;\n    this.cache.reset();\n    this.absMinIndex = this.minIndexUser;\n    this.absMaxIndex = this.maxIndexUser;\n    if (typeof startIndex !== 'undefined') {\n      this.startIndex = startIndex;\n    }\n  }\n\n  set items(items: Array<Item>) {\n    this.pristine = false;\n    this._items = items;\n    this.$items.next(items);\n  }\n\n  get items(): Array<Item> {\n    return this._items;\n  }\n\n  get size(): number {\n    return this._items.length;\n  }\n\n  get averageSize(): number {\n    return this.cache.averageSize;\n  }\n\n  get hasItemSize(): boolean {\n    return this.averageSize !== undefined;\n  }\n\n  get minIndex(): number {\n    return isFinite(this.cache.minIndex) ? this.cache.minIndex : this.startIndex;\n  }\n\n  get maxIndex(): number {\n    return isFinite(this.cache.maxIndex) ? this.cache.maxIndex : this.startIndex;\n  }\n\n  get bof(): boolean {\n    return this.items.length ? (this.items[0].$index === this.absMinIndex) :\n      isFinite(this.absMinIndex);\n  }\n\n  get eof(): boolean {\n    return this.items.length ? (this.items[this.items.length - 1].$index === this.absMaxIndex) :\n      isFinite(this.absMaxIndex);\n  }\n\n  get($index: number): Item | undefined {\n    return this.items.find((item: Item) => item.$index === $index);\n  }\n\n  setItems(items: Array<Item>): boolean {\n    if (!this.items.length) {\n      this.items = items;\n    } else if (this.items[0].$index > items[items.length - 1].$index) {\n      this.items = [...items, ...this.items];\n    } else if (items[0].$index > this.items[this.items.length - 1].$index) {\n      this.items = [...this.items, ...items];\n    } else {\n      return false;\n    }\n    return true;\n  }\n\n  getFirstVisibleItemIndex(): number {\n    const length = this.items.length;\n    for (let i = 0; i < length; i++) {\n      if (!this.items[i].invisible) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  getLastVisibleItemIndex(): number {\n    for (let i = this.items.length - 1; i >= 0; i--) {\n      if (!this.items[i].invisible) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  getFirstVisibleItem(): Item | undefined {\n    const index = this.getFirstVisibleItemIndex();\n    if (index >= 0) {\n      return this.items[index];\n    }\n  }\n\n  getLastVisibleItem(): Item | undefined {\n    const index = this.getLastVisibleItemIndex();\n    if (index >= 0) {\n      return this.items[index];\n    }\n  }\n\n  getEdgeVisibleItem(direction: Direction, opposite?: boolean): Item | undefined {\n    return direction === (!opposite ? Direction.forward : Direction.backward) ?\n      this.getLastVisibleItem() : this.getFirstVisibleItem();\n  }\n\n  getVisibleItemsCount(): number {\n    return this.items.reduce((acc: number, item: Item) => acc + (item.invisible ? 0 : 1), 0);\n  }\n\n  getSizeByIndex(index: number): number {\n    const item = this.cache.get(index);\n    return item ? item.size : this.averageSize;\n  }\n\n  checkAverageSize() {\n    this.cache.recalculateAverageSize();\n  }\n\n}\n","import { Item } from './item';\nimport { Direction } from '../interfaces/index';\n\nexport class FetchModel {\n  private _newItemsData: Array<any> | null;\n  items: Array<Item>;\n  firstIndexBuffer: number | null;\n  lastIndexBuffer: number | null;\n  firstIndex: number | null;\n  lastIndex: number | null;\n  hasAnotherPack: boolean;\n  callCount: number;\n  minIndex: number;\n  negativeSize: number;\n  averageItemSize: number;\n  direction: Direction | null;\n  isPrepend: boolean;\n\n  constructor() {\n    this.callCount = 0;\n    this.reset();\n  }\n\n  reset() {\n    this._newItemsData = null;\n    this.items = [];\n    this.firstIndexBuffer = null;\n    this.lastIndexBuffer = null;\n    this.firstIndex = null;\n    this.lastIndex = null;\n    this.hasAnotherPack = false;\n    this.negativeSize = 0;\n    this.direction = null;\n    this.isPrepend = false;\n  }\n\n  get newItemsData(): Array<Item> | null {\n    return this._newItemsData;\n  }\n\n  set newItemsData(items: Array<Item> | null) {\n    this._newItemsData = items;\n    this.callCount++;\n  }\n\n  get shouldFetch(): boolean {\n    return !!this.count;\n  }\n\n  get hasNewItems(): boolean {\n    return !!((this._newItemsData && this._newItemsData.length));\n  }\n\n  get index(): number | null {\n    return this.firstIndex;\n  }\n\n  get count(): number {\n    return this.firstIndex !== null && this.lastIndex !== null ? this.lastIndex - this.firstIndex + 1 : 0;\n  }\n}\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nimport {\r\n  State as IState,\r\n  ProcessRun,\r\n  ItemAdapter,\r\n  WindowScrollState as IWindowScrollState,\r\n  ScrollState as IScrollState,\r\n  SyntheticScroll as ISyntheticScroll\r\n} from '../interfaces/index';\r\nimport { FetchModel } from './fetch';\r\nimport { Settings } from './settings';\r\nimport { Logger } from './logger';\r\nimport { itemAdapterEmpty } from './adapter';\r\n\r\nclass WindowScrollState implements IWindowScrollState {\r\n  positionToUpdate: number;\r\n  delta: number;\r\n\r\n  constructor() {\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    this.delta = 0;\r\n    this.positionToUpdate = 0;\r\n  }\r\n}\r\n\r\nclass ScrollState implements IScrollState {\r\n  firstScroll: boolean;\r\n  firstScrollTime: number;\r\n  lastScrollTime: number;\r\n  scrollTimer: number | null;\r\n  workflowTimer: number | null;\r\n  scroll: boolean;\r\n  keepScroll: boolean;\r\n  window: IWindowScrollState;\r\n\r\n  constructor() {\r\n    this.window = new WindowScrollState();\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    this.firstScroll = false;\r\n    this.firstScrollTime = 0;\r\n    this.lastScrollTime = 0;\r\n    this.scrollTimer = null;\r\n    this.workflowTimer = null;\r\n    this.scroll = false;\r\n    this.keepScroll = false;\r\n    this.window.reset();\r\n  }\r\n}\r\n\r\nclass SyntheticScroll implements ISyntheticScroll {\r\n  position: number | null;\r\n  positionBefore: number | null;\r\n  delta: number;\r\n  time: number;\r\n  readyToReset: boolean;\r\n\r\n  constructor() {\r\n    this.reset(null);\r\n  }\r\n\r\n  reset(position: number | null = null) {\r\n    this.position = position;\r\n    this.positionBefore = null;\r\n    this.delta = 0;\r\n    this.time = 0;\r\n    this.readyToReset = false;\r\n  }\r\n}\r\n\r\nexport class State implements IState {\r\n\r\n  protected settings: Settings;\r\n  protected logger: Logger;\r\n\r\n  initTime: number;\r\n  innerLoopCount: number;\r\n  isInitialLoop: boolean;\r\n  workflowCycleCount: number;\r\n  isInitialWorkflowCycle: boolean;\r\n  countDone: number;\r\n\r\n  startIndex: number;\r\n  fetch: FetchModel;\r\n  clip: boolean;\r\n  clipCall: number;\r\n  lastPosition: number;\r\n  preFetchPosition: number;\r\n  preAdjustPosition: number;\r\n  sizeBeforeRender: number;\r\n  fwdPaddingBeforeRender: number;\r\n  bwdPaddingAverageSizeItemsCount: number;\r\n\r\n  scrollState: IScrollState;\r\n  syntheticScroll: ISyntheticScroll;\r\n\r\n  loopPendingSource: BehaviorSubject<boolean>;\r\n  workflowPendingSource: BehaviorSubject<boolean>;\r\n  isLoadingSource: BehaviorSubject<boolean>;\r\n  firstVisibleSource: BehaviorSubject<ItemAdapter>;\r\n  lastVisibleSource: BehaviorSubject<ItemAdapter>;\r\n  firstVisibleWanted: boolean;\r\n  lastVisibleWanted: boolean;\r\n\r\n  get loopPending(): boolean {\r\n    return this.loopPendingSource.getValue();\r\n  }\r\n\r\n  set loopPending(value: boolean) {\r\n    if (this.loopPending !== value) {\r\n      this.loopPendingSource.next(value);\r\n    }\r\n  }\r\n\r\n  get workflowPending(): boolean {\r\n    return this.workflowPendingSource.getValue();\r\n  }\r\n\r\n  set workflowPending(value: boolean) {\r\n    if (this.workflowPending !== value) {\r\n      this.workflowPendingSource.next(value);\r\n    }\r\n  }\r\n\r\n  get isLoading(): boolean {\r\n    return this.isLoadingSource.getValue();\r\n  }\r\n\r\n  set isLoading(value: boolean) {\r\n    if (this.isLoading !== value) {\r\n      this.isLoadingSource.next(value);\r\n    }\r\n  }\r\n\r\n  get firstVisibleItem(): ItemAdapter {\r\n    return this.firstVisibleSource.getValue();\r\n  }\r\n\r\n  set firstVisibleItem(item: ItemAdapter) {\r\n    if (this.firstVisibleItem.$index !== item.$index) {\r\n      this.firstVisibleSource.next(item);\r\n    }\r\n  }\r\n\r\n  get lastVisibleItem(): ItemAdapter {\r\n    return this.lastVisibleSource.getValue();\r\n  }\r\n\r\n  set lastVisibleItem(item: ItemAdapter) {\r\n    if (this.lastVisibleItem.$index !== item.$index) {\r\n      this.lastVisibleSource.next(item);\r\n    }\r\n  }\r\n\r\n  get time(): number {\r\n    return Number(new Date()) - this.initTime;\r\n  }\r\n\r\n  constructor(settings: Settings, logger: Logger) {\r\n    this.settings = settings;\r\n    this.logger = logger;\r\n    this.initTime = Number(new Date());\r\n    this.innerLoopCount = 0;\r\n    this.isInitialLoop = false;\r\n    this.workflowCycleCount = 1;\r\n    this.isInitialWorkflowCycle = false;\r\n    this.countDone = 0;\r\n\r\n    this.setCurrentStartIndex(settings.startIndex);\r\n    this.fetch = new FetchModel();\r\n    this.clip = false;\r\n    this.clipCall = 0;\r\n    this.sizeBeforeRender = 0;\r\n    this.fwdPaddingBeforeRender = 0;\r\n    this.bwdPaddingAverageSizeItemsCount = 0;\r\n\r\n    this.scrollState = new ScrollState();\r\n    this.syntheticScroll = new SyntheticScroll();\r\n\r\n    this.loopPendingSource = new BehaviorSubject<boolean>(false);\r\n    this.workflowPendingSource = new BehaviorSubject<boolean>(false);\r\n    this.isLoadingSource = new BehaviorSubject<boolean>(false);\r\n    this.firstVisibleSource = new BehaviorSubject<ItemAdapter>(itemAdapterEmpty);\r\n    this.lastVisibleSource = new BehaviorSubject<ItemAdapter>(itemAdapterEmpty);\r\n    this.firstVisibleWanted = false;\r\n    this.lastVisibleWanted = false;\r\n  }\r\n\r\n  startLoop(options?: ProcessRun) {\r\n    this.loopPending = true;\r\n    this.innerLoopCount++;\r\n    this.fetch.reset();\r\n    this.clip = false;\r\n    if (options) {\r\n      this.scrollState.scroll = options.scroll || false;\r\n    }\r\n    this.scrollState.keepScroll = false;\r\n  }\r\n\r\n  endLoop() {\r\n    this.loopPending = false;\r\n    this.countDone++;\r\n    this.isInitialLoop = false;\r\n  }\r\n\r\n  setCurrentStartIndex(newStartIndex: any) {\r\n    const { startIndex, minIndex, maxIndex } = this.settings;\r\n    let index = Number(newStartIndex);\r\n    if (isNaN(index)) {\r\n      this.logger.log(() =>\r\n        `fallback startIndex to settings.startIndex (${startIndex}) because ${newStartIndex} is not a number`);\r\n      index = startIndex;\r\n    }\r\n    if (index < minIndex) {\r\n      this.logger.log(() => `setting startIndex to settings.minIndex (${minIndex}) because ${index} < ${minIndex}`);\r\n      index = minIndex;\r\n    }\r\n    if (index > maxIndex) {\r\n      this.logger.log(() => `setting startIndex to settings.maxIndex (${maxIndex}) because ${index} > ${maxIndex}`);\r\n      index = maxIndex;\r\n    }\r\n    this.startIndex = index;\r\n  }\r\n\r\n}\r\n","import { Observable, Subscription, Observer } from 'rxjs';\n\nimport { UiScrollComponent } from '../ui-scroll.component';\nimport { checkDatasource } from './utils/index';\nimport { Datasource } from './classes/datasource';\nimport { Settings } from './classes/settings';\nimport { Logger } from './classes/logger';\nimport { Routines } from './classes/domRoutines';\nimport { Viewport } from './classes/viewport';\nimport { Buffer } from './classes/buffer';\nimport { State } from './classes/state';\nimport { CallWorkflow } from './interfaces/index';\n\nlet instanceCount = 0;\n\nexport class Scroller {\n\n  readonly runChangeDetector: Function;\n  readonly callWorkflow: CallWorkflow;\n\n  public version: string;\n  public datasource: Datasource;\n  public settings: Settings;\n  public logger: Logger;\n  public routines: Routines;\n  public viewport: Viewport;\n  public buffer: Buffer;\n  public state: State;\n\n  public innerLoopSubscriptions: Array<Subscription>;\n\n  constructor(context: UiScrollComponent, callWorkflow: CallWorkflow) {\n    const datasource = <Datasource>checkDatasource(context.datasource);\n    this.datasource = datasource;\n    this.version = context.version;\n\n    this.runChangeDetector = () => context.changeDetector.markForCheck();\n    // this.runChangeDetector = () => context.changeDetector.detectChanges();\n    this.callWorkflow = callWorkflow;\n    this.innerLoopSubscriptions = [];\n\n    this.settings = new Settings(datasource.settings, datasource.devSettings, ++instanceCount);\n    this.logger = new Logger(this);\n    this.routines = new Routines(this.settings);\n    this.state = new State(this.settings, this.logger);\n    this.buffer = new Buffer(this.settings, this.state.startIndex, this.logger);\n    this.viewport = new Viewport(context.elementRef, this.settings, this.routines, this.state, this.logger);\n\n    this.logger.object('uiScroll settings object', this.settings, true);\n\n    if (!datasource.constructed) {\n      this.datasource = new Datasource(datasource, !this.settings.adapter);\n      if (this.settings.adapter) {\n        this.datasource.adapter.initialize(this);\n      }\n    } else {\n      this.datasource.adapter.initialize(this);\n    }\n  }\n\n  init() {\n    this.viewport.reset(0);\n  }\n\n  bindData(): Observable<any> {\n    this.runChangeDetector();\n    return Observable.create((observer: Observer<any>) => {\n        setTimeout(() => {\n          observer.next(true);\n          observer.complete();\n        });\n      }\n    );\n  }\n\n  purgeInnerLoopSubscriptions() {\n    this.innerLoopSubscriptions.forEach((item: Subscription) => item.unsubscribe());\n    this.innerLoopSubscriptions = [];\n  }\n\n  purgeScrollTimers(localOnly?: boolean) {\n    const { state: { scrollState } } = this;\n    if (scrollState.scrollTimer) {\n      clearTimeout(scrollState.scrollTimer);\n      scrollState.scrollTimer = null;\n    }\n    if (!localOnly && scrollState.workflowTimer) {\n      clearTimeout(scrollState.workflowTimer);\n      scrollState.workflowTimer = null;\n    }\n  }\n\n  dispose() {\n    this.purgeInnerLoopSubscriptions();\n    this.purgeScrollTimers();\n  }\n\n  finalize() {\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus, ProcessRun } from '../interfaces/index';\n\nexport default class Init {\n\n  static run(scroller: Scroller, payload?: ProcessRun) {\n    scroller.state.isInitialWorkflowCycle = !payload;\n    scroller.state.isInitialLoop = !payload;\n    scroller.state.workflowPending = true;\n    scroller.state.isLoading = true;\n    scroller.callWorkflow({\n      process: Process.init,\n      status: ProcessStatus.next,\n      payload: {\n        scroll: payload && payload.scroll || false\n      }\n    });\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus, ScrollPayload } from '../interfaces/index';\n\nexport default class Scroll {\n\n  static run(scroller: Scroller, payload: ScrollPayload = {}) {\n    scroller.logger.log(scroller.viewport.scrollPosition);\n    if (scroller.state.syntheticScroll.position !== null) {\n      if (!Scroll.processSyntheticScroll(scroller)) {\n        return;\n      }\n    }\n    this.delayScroll(scroller, payload);\n  }\n\n  static processSyntheticScroll(scroller: Scroller): boolean {\n    const { viewport, state: { syntheticScroll }, settings, logger } = scroller;\n    const time = Number(new Date());\n    const synthetic = { ...syntheticScroll };\n    const position = viewport.scrollPosition;\n    const synthScrollDelay = time - synthetic.time;\n\n    if (synthScrollDelay > settings.maxSynthScrollDelay) {\n      logger.log(() => `reset synthetic scroll params (${synthScrollDelay} > ${settings.maxSynthScrollDelay})`);\n      syntheticScroll.reset();\n      return position !== synthetic.position;\n    }\n\n    // synthetic scroll\n    syntheticScroll.readyToReset = true;\n    if (position === synthetic.position) {\n      // let's reset syntheticScroll.position on first change\n      logger.log(() => `skip synthetic scroll (${position})`);\n      return false;\n    } else if (synthetic.readyToReset) {\n      syntheticScroll.position = null;\n      syntheticScroll.positionBefore = null;\n      logger.log(() => 'reset synthetic scroll params');\n    }\n    if (settings.windowViewport) {\n      if (!synthetic.readyToReset) {\n        logger.log(() => 'reset synthetic scroll params (window)');\n        syntheticScroll.reset();\n      }\n      return true;\n    }\n\n    // inertia scroll over synthetic scroll\n    if (position !== synthetic.position) {\n      const inertiaDelta = <number>synthetic.positionBefore - position;\n      const syntheticDelta = <number>synthetic.position - position;\n      if (inertiaDelta > 0 && inertiaDelta < syntheticDelta) {\n        const newPosition = Math.max(0, position + syntheticScroll.delta);\n        logger.log(() => 'inertia scroll adjustment' +\n          '. Position: ' + position +\n          ', synthetic position: ' + synthetic.position +\n          ', synthetic position before: ' + synthetic.positionBefore +\n          ', synthetic delay: ' + synthScrollDelay +\n          ', synthetic delta: ' + syntheticDelta +\n          ', inertia delta: ' + inertiaDelta +\n          ', new position: ' + newPosition);\n        if (settings.inertia) { // precise inertia settings\n          if (inertiaDelta <= settings.inertiaScrollDelta && synthScrollDelay <= settings.inertiaScrollDelay) {\n            viewport.scrollPosition = newPosition;\n          }\n        } else {\n          viewport.scrollPosition = newPosition;\n        }\n      } /* else {\n        logger.log(() => 'inertia scroll adjustment [cancelled]' +\n          '. Position: ' + position +\n          ', synthetic position: ' + synthetic.position +\n          ', synthetic position before: ' + synthetic.positionBefore +\n          ', synthetic delta: ' + syntheticDelta + ', inertia delta: ' + inertiaDelta);\n      } */\n    }\n    return true;\n  }\n\n  static delayScroll(scroller: Scroller, payload: ScrollPayload) {\n    if (!scroller.settings.throttle || payload.byTimer) {\n      Scroll.doScroll(scroller);\n      return;\n    }\n    const { state: { scrollState } } = scroller;\n    const time = Number(Date.now());\n    const tDiff = scrollState.lastScrollTime + scroller.settings.throttle - time;\n    const dDiff = scroller.settings.throttle + (scrollState.firstScrollTime ? scrollState.firstScrollTime - time : 0);\n    const diff = Math.max(tDiff, dDiff);\n    // scroller.logger.log('tDiff:', tDiff, 'dDiff:', dDiff, 'diff:', diff);\n    if (diff <= 0) {\n      scroller.purgeScrollTimers(true);\n      scrollState.lastScrollTime = time;\n      scrollState.firstScrollTime = 0;\n      Scroll.doScroll(scroller);\n    } else if (!scrollState.scrollTimer && !scrollState.keepScroll) {\n      scroller.logger.log(() => `setting the timer at ${scroller.state.time + diff}`);\n      scrollState.firstScrollTime = time;\n      scrollState.scrollTimer = <any>setTimeout(() => {\n        scrollState.scrollTimer = null;\n        scroller.logger.log(() => `fire the timer (${scroller.state.time})`);\n        Scroll.run(scroller, { byTimer: true });\n      }, diff);\n    } /* else {\n      scroller.logger.log('MISS TIMER');\n    } */\n  }\n\n  static doScroll(scroller: Scroller) {\n    const { state, state: { scrollState } } = scroller;\n    if (state.workflowPending) {\n      scroller.logger.log(() =>\n        !scrollState.keepScroll ? [\n          `setting %ckeepScroll%c flag (scrolling while the Workflow is pending)`,\n          'color: #006600;', 'color: #000000;'\n        ] : undefined);\n      scrollState.keepScroll = true;\n      return;\n    }\n    scroller.callWorkflow({\n      process: Process.scroll,\n      status: ProcessStatus.next,\n      payload: {\n        scroll: true,\n        ...(scrollState.keepScroll ? { keepScroll: scrollState.keepScroll } : {})\n      }\n    });\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus } from '../interfaces/index';\n\nexport default class Reload {\n\n  static run(scroller: Scroller, reloadIndex: any) {\n    const scrollPosition = scroller.viewport.scrollPosition;\n    scroller.state.setCurrentStartIndex(reloadIndex);\n    scroller.buffer.reset(true, scroller.state.startIndex);\n    scroller.viewport.reset(scrollPosition);\n    scroller.purgeInnerLoopSubscriptions();\n    scroller.purgeScrollTimers();\n    // todo: do we need to have Process.end before?\n    scroller.callWorkflow({\n      process: Process.reload,\n      status: ProcessStatus.next\n    });\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessRun, ProcessStatus } from '../interfaces/index';\n\nexport default class Start {\n\n  static run(scroller: Scroller, payload?: ProcessRun) {\n    scroller.state.startLoop(payload);\n    scroller.callWorkflow({\n      process: Process.start,\n      status: ProcessStatus.next\n    });\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus, Direction } from '../interfaces/index';\n\nexport default class PreFetch {\n\n  static run(scroller: Scroller) {\n    const { fetch } = scroller.state;\n    scroller.state.preFetchPosition = scroller.viewport.scrollPosition;\n    fetch.minIndex = scroller.buffer.minIndex;\n    fetch.averageItemSize = scroller.buffer.averageSize || 0;\n\n    // calculate size before start index\n    PreFetch.setStartDelta(scroller);\n\n    // set first and last indexes to fetch\n    PreFetch.setFetchIndexes(scroller);\n\n    // skip indexes that are in buffer\n    PreFetch.skipBufferedItems(scroller);\n\n    // add indexes if there are too few items to fetch (clip padding)\n    PreFetch.checkFetchPackSize(scroller);\n\n    // set fetch direction\n    PreFetch.setFetchDirection(scroller);\n\n    if (fetch.shouldFetch) {\n      scroller.logger.log(() => `going to fetch ${fetch.count} items started from index ${fetch.index}`);\n    }\n\n    scroller.callWorkflow({\n      process: Process.preFetch,\n      status: scroller.state.fetch.shouldFetch ? ProcessStatus.next : ProcessStatus.done\n    });\n  }\n\n  static setStartDelta(scroller: Scroller) {\n    const { buffer, viewport } = scroller;\n    viewport.startDelta = 0;\n    if (!buffer.hasItemSize) {\n      return;\n    }\n    const minIndex = isFinite(buffer.absMinIndex) ? buffer.absMinIndex : buffer.minIndex;\n    for (let index = minIndex; index < scroller.state.startIndex; index++) {\n      const item = buffer.cache.get(index);\n      viewport.startDelta += item ? item.size : buffer.averageSize;\n    }\n    if (scroller.settings.windowViewport) {\n      viewport.startDelta += viewport.getOffset();\n    }\n    scroller.logger.log(() => `start delta is ${viewport.startDelta}`);\n  }\n\n  static setFetchIndexes(scroller: Scroller) {\n    const { state, viewport } = scroller;\n    const paddingDelta = viewport.getBufferPadding();\n    const relativePosition = state.preFetchPosition - viewport.startDelta;\n    const startPosition = relativePosition - paddingDelta;\n    const endPosition = relativePosition + viewport.getSize() + paddingDelta;\n    const firstIndexPosition =\n      PreFetch.setFirstIndexBuffer(scroller, startPosition);\n    PreFetch.setLastIndexBuffer(scroller, firstIndexPosition, endPosition);\n    scroller.logger.fetch();\n  }\n\n  static setFirstIndexBuffer(scroller: Scroller, startPosition: number): number {\n    const { state, buffer, state: { fetch } } = scroller;\n    let firstIndex = state.startIndex;\n    let firstIndexPosition = 0;\n    if (scroller.state.isInitialLoop) {\n      scroller.logger.log(`skipping fetch backward direction [initial loop]`);\n    } else {\n      const inc = startPosition < 0 ? -1 : 1;\n      let position = firstIndexPosition;\n      let index = firstIndex;\n      while (1) {\n        index += inc;\n        if (index < buffer.absMinIndex) {\n          break;\n        }\n        position += inc * buffer.getSizeByIndex(index);\n        if (inc < 0) {\n          firstIndex = index;\n          firstIndexPosition = position;\n          if (position <= startPosition) {\n            break;\n          }\n        } else {\n          if (position > startPosition) {\n            break;\n          }\n          firstIndex = index;\n          firstIndexPosition = position;\n        }\n      }\n    }\n    fetch.firstIndex = fetch.firstIndexBuffer = Math.max(firstIndex, buffer.absMinIndex);\n    return firstIndexPosition;\n  }\n\n  static setLastIndexBuffer(scroller: Scroller, startPosition: number, endPosition: number) {\n    const { state, buffer, settings } = scroller;\n    let lastIndex;\n    if (!buffer.hasItemSize) {\n      // just to fetch forward bufferSize items if neither averageItemSize nor itemSize are present\n      lastIndex = state.startIndex + settings.bufferSize - 1;\n      scroller.logger.log(`forcing fetch forward direction [no item size]`);\n    } else {\n      let index = <number>state.fetch.firstIndexBuffer;\n      let position = startPosition;\n      let lastIndexPosition;\n      lastIndex = index;\n      while (1) {\n        lastIndex = index;\n        index++;\n        position += buffer.getSizeByIndex(index);\n        lastIndexPosition = position;\n        if (position >= endPosition) {\n          break;\n        }\n        if (index > buffer.absMaxIndex) {\n          break;\n        }\n      }\n    }\n    state.fetch.lastIndex = state.fetch.lastIndexBuffer = Math.min(lastIndex, buffer.absMaxIndex);\n  }\n\n  static skipBufferedItems(scroller: Scroller) {\n    const buffer = scroller.buffer;\n    if (!buffer.size) {\n      return;\n    }\n    const { fetch } = scroller.state;\n    const firstIndex = <number>fetch.firstIndex;\n    const lastIndex = <number>fetch.lastIndex;\n    const packs: Array<Array<number>> = [[]];\n    let p = 0;\n    for (let i = firstIndex; i <= lastIndex; i++) {\n      if (!buffer.get(i)) {\n        packs[p].push(i);\n      } else if (packs[p].length) {\n        packs[++p] = [];\n      }\n    }\n    let pack = packs[0];\n    if (packs[0].length && packs[1] && packs[1].length) {\n      fetch.hasAnotherPack = true;\n      // todo: need to look for biggest pack in visible area\n      // todo: or think about merging two requests in a single Fetch process\n      if (packs[1].length >= packs[0].length) {\n        pack = packs[1];\n      }\n    }\n    fetch.firstIndex = Math.max(pack[0], buffer.absMinIndex);\n    fetch.lastIndex = Math.min(pack[pack.length - 1], buffer.absMaxIndex);\n    if (fetch.firstIndex !== firstIndex || fetch.lastIndex !== lastIndex) {\n      scroller.logger.fetch('after Buffer flushing');\n    }\n  }\n\n  static checkFetchPackSize(scroller: Scroller) {\n    const { buffer, state: { fetch } } = scroller;\n    if (!fetch.shouldFetch) {\n      return;\n    }\n    const firstIndex = <number>fetch.firstIndex;\n    const lastIndex = <number>fetch.lastIndex;\n    const diff = scroller.settings.bufferSize - (lastIndex - firstIndex + 1);\n    if (diff <= 0) {\n      return;\n    }\n    if (!buffer.size || lastIndex > buffer.items[0].$index) { // forward\n      const newLastIndex = Math.min(lastIndex + diff, buffer.absMaxIndex);\n      if (newLastIndex > lastIndex) {\n        fetch.lastIndex = fetch.lastIndexBuffer = newLastIndex;\n      }\n    } else {\n      const newFirstIndex = Math.max(firstIndex - diff, buffer.absMinIndex);\n      if (newFirstIndex < firstIndex) {\n        fetch.firstIndex = fetch.firstIndexBuffer = newFirstIndex;\n      }\n    }\n    if (fetch.firstIndex !== firstIndex || fetch.lastIndex !== lastIndex) {\n      scroller.logger.fetch('after bufferSize adjustment');\n      PreFetch.skipBufferedItems(scroller);\n    }\n  }\n\n  static setFetchDirection(scroller: Scroller) {\n    const { buffer, state: { fetch } } = scroller;\n    if (fetch.lastIndex) {\n      let direction = Direction.forward;\n      if (buffer.size) {\n        direction = fetch.lastIndex < buffer.items[0].$index ? Direction.backward : Direction.forward;\n      }\n      fetch.direction = direction;\n      scroller.logger.log(() => `fetch direction is \"${direction}\"`);\n    }\n  }\n\n}\n","import { Observable, Observer } from 'rxjs';\n\nimport { Scroller } from '../scroller';\nimport { Process, ProcessStatus } from '../interfaces/index';\n\nexport default class Fetch {\n\n  static run(scroller: Scroller) {\n    const result = Fetch.get(scroller);\n    if (typeof result.subscribe !== 'function') {\n      if (!result.isError) {\n        Fetch.success(result.data, scroller);\n      } else {\n        Fetch.fail(result.error, scroller);\n      }\n    } else {\n      scroller.innerLoopSubscriptions.push(\n        result.subscribe(\n          (data: Array<any>) => Fetch.success(data, scroller),\n          (error: any) => Fetch.fail(error, scroller)\n        )\n      );\n    }\n  }\n\n  static success(data: Array<any>, scroller: Scroller) {\n    scroller.logger.log(() => `resolved ${data.length} items ` +\n      `(index = ${scroller.state.fetch.index}, count = ${scroller.state.fetch.count})`);\n    scroller.state.fetch.newItemsData = data;\n\n    scroller.callWorkflow({\n      process: Process.fetch,\n      status: ProcessStatus.next\n    });\n  }\n\n  static fail(error: string, scroller: Scroller) {\n    scroller.callWorkflow({\n      process: Process.fetch,\n      status: ProcessStatus.error,\n      payload: { error }\n    });\n  }\n\n  static get(scroller: Scroller) {\n    const _get = <Function>scroller.datasource.get;\n\n    let immediateData, immediateError;\n    let observer: Observer<any>;\n    const success = (data: any) => {\n      if (!observer) {\n        immediateData = data || null;\n        return;\n      }\n      observer.next(data);\n      observer.complete();\n    };\n    const reject = (error: any) => {\n      if (!observer) {\n        immediateError = error || null;\n        return;\n      }\n      observer.error(error);\n    };\n\n    const result = _get(scroller.state.fetch.index, scroller.state.fetch.count, success, reject);\n    if (result && typeof result.then === 'function') { // DatasourceGetPromise\n      result.then(success, reject);\n    } else if (result && typeof result.subscribe === 'function') { // DatasourceGetObservable\n      return result; // do not wrap observable\n    }\n\n    if (immediateData !== undefined || immediateError !== undefined) {\n      return {\n        data: immediateData,\n        error: immediateError,\n        isError: immediateError !== undefined\n      };\n    }\n\n    return Observable.create((_observer: Observer<any>) => {\n      observer = _observer;\n    });\n  }\n\n}\n","import { Routines } from './domRoutines';\nimport { Direction } from '../interfaces/index';\n\nexport class Item {\n  $index: number;\n  data: any;\n  nodeId: string;\n  routines: Routines;\n\n  element: HTMLElement;\n  size: number;\n  invisible: boolean;\n  toRemove: boolean;\n  removeDirection: Direction;\n\n  constructor($index: number, data: any, routines: Routines) {\n    this.$index = $index;\n    this.data = data;\n    this.nodeId = String($index);\n    this.routines = routines;\n    this.invisible = true;\n  }\n\n  setSize() {\n    this.size = this.routines.getSize(this.element);\n  }\n\n  hide() {\n    if (this.element) {\n      this.routines.hideElement(this.element);\n    }\n  }\n}\n","import { Scroller } from '../scroller';\nimport { Item } from '../classes/item';\nimport { Process, ProcessStatus } from '../interfaces/index';\n\nexport default class PostFetch {\n\n  static run(scroller: Scroller) {\n    if (PostFetch.setItems(scroller)) {\n      PostFetch.setBufferLimits(scroller);\n      scroller.callWorkflow({\n        process: Process.postFetch,\n        status: scroller.state.fetch.hasNewItems ? ProcessStatus.next : ProcessStatus.done\n      });\n    } else {\n      scroller.callWorkflow({\n        process: Process.postFetch,\n        status: ProcessStatus.error,\n        payload: { error: 'Can\\'t set buffer items' }\n      });\n    }\n  }\n\n  static setBufferLimits(scroller: Scroller) {\n    const { buffer, state: { fetch: { firstIndex, lastIndex, items } } } = scroller;\n    if (!items.length) {\n      if (<number>lastIndex < buffer.minIndex) {\n        buffer.absMinIndex = buffer.minIndex;\n      }\n      if (<number>firstIndex > buffer.maxIndex) {\n        buffer.absMaxIndex = buffer.maxIndex;\n      }\n    } else {\n      const last = items.length - 1;\n      if (<number>firstIndex < items[0].$index) {\n        buffer.absMinIndex = items[0].$index;\n      }\n      if (<number>lastIndex > items[last].$index) {\n        buffer.absMaxIndex = items[last].$index;\n      }\n    }\n  }\n\n  static setItems(scroller: Scroller): boolean {\n    const { buffer, state: { fetch } } = scroller;\n    const items = fetch.newItemsData;\n    if (!items || !items.length) { // empty result\n      return true;\n    }\n    // eof/bof case, need to shift fetch index if bof\n    let fetchIndex = <number>fetch.index;\n    if (items.length < fetch.count) {\n      if (scroller.state.isInitialLoop) {\n        // let's treat initial poor fetch as startIndex-bof\n        fetchIndex = scroller.state.startIndex;\n      } else if (<number>fetch.firstIndex < buffer.minIndex) { // normal bof\n        fetchIndex = buffer.minIndex - items.length;\n      }\n    }\n    fetch.items = items.map((item, index: number) =>\n      new Item(fetchIndex + index, item, scroller.routines)\n    );\n    fetch.isPrepend = !!buffer.items.length && buffer.items[0].$index > fetch.items[fetch.items.length - 1].$index;\n    return buffer.setItems(fetch.items);\n  }\n\n}\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus } from '../interfaces/index';\n\nexport default class Render {\n\n  static run(scroller: Scroller) {\n    scroller.logger.stat('before new items render');\n    scroller.innerLoopSubscriptions.push(\n      scroller.bindData().subscribe(() => {\n        if (Render.processElements(scroller)) {\n          scroller.callWorkflow({\n            process: Process.render,\n            status: ProcessStatus.next\n          });\n        } else {\n          scroller.callWorkflow({\n            process: Process.render,\n            status: ProcessStatus.error,\n            payload: { error: 'Can\\'t associate item with element' }\n          });\n        }\n      })\n    );\n  }\n\n  static processElements(scroller: Scroller) {\n    const { state, state: { fetch, fetch: { items } }, viewport, buffer } = scroller;\n    const itemsLength = items.length;\n    const scrollBeforeRender = scroller.settings.windowViewport ? scroller.viewport.scrollPosition : 0;\n    state.sizeBeforeRender = viewport.getScrollableSize();\n    state.fwdPaddingBeforeRender = viewport.paddings.forward.size;\n    for (let j = 0; j < itemsLength; j++) {\n      const item = items[j];\n      const element = viewport.element.querySelector(`[data-sid=\"${item.nodeId}\"]`);\n      if (!element) {\n        return false;\n      }\n      item.element = <HTMLElement>element;\n      item.element.style.left = '';\n      item.element.style.position = '';\n      item.invisible = false;\n      item.setSize();\n      buffer.cache.add(item);\n      if (item.$index < fetch.minIndex) {\n        fetch.negativeSize += item.size;\n      }\n    }\n    buffer.checkAverageSize();\n    if (scroller.settings.windowViewport && fetch.isPrepend) {\n      Render.processWindowScrollBackJump(scroller, scrollBeforeRender);\n    }\n    scroller.logger.stat('after new items render');\n    return true;\n  }\n\n  static processWindowScrollBackJump(scroller: Scroller, scrollBeforeRender: number) {\n    const { state, state: { scrollState: { window } }, viewport } = scroller;\n    // if new items have been rendered in the area that is before current scroll position\n    // then this position will be updated silently in case of entire window scrollable\n    // so we need to remember the delta and to update scroll position manually right after it is changed silently\n    const inc = scrollBeforeRender >= viewport.paddings.backward.size ? 1 : -1;\n    const delta = inc * Math.abs(viewport.getScrollableSize() - state.sizeBeforeRender);\n    const positionToUpdate = scrollBeforeRender - delta;\n    if (delta && positionToUpdate > 0) {\n      window.positionToUpdate = positionToUpdate;\n      window.delta = delta;\n      scroller.logger.log(() => {\n        const token = delta < 0 ? 'reduced' : 'increased';\n        return [`next scroll position (if ${positionToUpdate}) should be ${token} by`, Math.abs(delta)];\n      });\n    }\n  }\n\n}\n","import { Scroller } from '../scroller';\r\nimport { Direction, Process, ProcessStatus } from '../interfaces/index';\r\n\r\nexport default class Adjust {\r\n\r\n  static MAX_SCROLL_ADJUSTMENTS_COUNT = 10;\r\n\r\n  static run(scroller: Scroller) {\r\n    scroller.state.preAdjustPosition = scroller.viewport.scrollPosition;\r\n\r\n    // padding-elements adjustments\r\n    const setPaddingsResult =\r\n      Adjust.setPaddings(scroller);\r\n\r\n    if (setPaddingsResult === false) {\r\n      scroller.callWorkflow({\r\n        process: Process.adjust,\r\n        status: ProcessStatus.error,\r\n        payload: { error: 'Can\\'t get visible item' }\r\n      });\r\n      return;\r\n    }\r\n\r\n    // scroll position adjustments\r\n    Adjust.fixScrollPosition(scroller, <number>setPaddingsResult);\r\n\r\n    scroller.callWorkflow({\r\n      process: Process.adjust,\r\n      status: ProcessStatus.done\r\n    });\r\n  }\r\n\r\n  static setPaddings(scroller: Scroller): boolean | number {\r\n    const { viewport, buffer, state: { fetch } } = scroller;\r\n    const firstItem = buffer.getFirstVisibleItem();\r\n    const lastItem = buffer.getLastVisibleItem();\r\n    if (!firstItem || !lastItem) {\r\n      return false;\r\n    }\r\n    const forwardPadding = viewport.paddings.forward;\r\n    const backwardPadding = viewport.paddings.backward;\r\n    const firstIndex = firstItem.$index;\r\n    const lastIndex = lastItem.$index;\r\n    const minIndex = isFinite(buffer.absMinIndex) ? buffer.absMinIndex : buffer.minIndex;\r\n    const maxIndex = isFinite(buffer.absMaxIndex) ? buffer.absMaxIndex : buffer.maxIndex;\r\n    const hasAverageItemSizeChanged = buffer.averageSize !== fetch.averageItemSize;\r\n    let index, bwdSize = 0, fwdSize = 0, bwdPaddingAverageSizeItemsCount = 0;\r\n\r\n    // new backward padding\r\n    for (index = minIndex; index < firstIndex; index++) {\r\n      const item = buffer.cache.get(index);\r\n      bwdSize += item ? item.size : buffer.cache.averageSize;\r\n      if (hasAverageItemSizeChanged) {\r\n        bwdPaddingAverageSizeItemsCount += !item ? 1 : 0;\r\n      }\r\n    }\r\n    if (hasAverageItemSizeChanged) {\r\n      for (index = firstIndex; index < <number>fetch.firstIndexBuffer; index++) {\r\n        bwdPaddingAverageSizeItemsCount += !buffer.cache.get(index) ? 1 : 0;\r\n      }\r\n    }\r\n\r\n    // new forward padding\r\n    for (index = lastIndex + 1; index <= maxIndex; index++) {\r\n      const item = buffer.cache.get(index);\r\n      fwdSize += item ? item.size : buffer.cache.averageSize;\r\n    }\r\n    const fwdPaddingDiff = forwardPadding.size - fwdSize;\r\n    const viewportSizeDiff = viewport.getSize() - viewport.getScrollableSize() + fwdPaddingDiff;\r\n    if (viewportSizeDiff > 0) {\r\n      fwdSize += viewportSizeDiff;\r\n      scroller.logger.log(`forward padding will be increased by ${viewportSizeDiff} to fill the viewport`);\r\n    }\r\n\r\n    forwardPadding.size = fwdSize;\r\n    backwardPadding.size = bwdSize;\r\n\r\n    scroller.logger.stat('after paddings adjustments');\r\n    return bwdPaddingAverageSizeItemsCount;\r\n  }\r\n\r\n  static fixScrollPosition(scroller: Scroller, bwdPaddingAverageSizeItemsCount: number) {\r\n    const { viewport, buffer, state, state: { fetch, fetch: { items, negativeSize } } } = scroller;\r\n\r\n    if (scroller.settings.windowViewport) {\r\n      const newPosition = viewport.scrollPosition;\r\n      const posDiff = state.preAdjustPosition - newPosition;\r\n      if (posDiff) {\r\n        const winState = state.scrollState.window;\r\n        if (newPosition === winState.positionToUpdate) {\r\n          winState.reset();\r\n          state.syntheticScroll.readyToReset = false;\r\n          scroller.logger.log(() => `process window scroll preventive: sum(${newPosition}, ${posDiff})`);\r\n          Adjust.setScroll(scroller, posDiff);\r\n          scroller.logger.stat('after scroll position adjustment (window)');\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    // if backward padding has been changed due to average item size change\r\n    const hasAverageItemSizeChanged = buffer.averageSize !== fetch.averageItemSize;\r\n    const bwdAverageItemsCountDiff = state.bwdPaddingAverageSizeItemsCount - bwdPaddingAverageSizeItemsCount;\r\n    const hasBwdParamsChanged = bwdPaddingAverageSizeItemsCount > 0 || bwdAverageItemsCountDiff > 0;\r\n    if (hasAverageItemSizeChanged && hasBwdParamsChanged) {\r\n      const _bwdPaddingAverageSize = bwdPaddingAverageSizeItemsCount * buffer.averageSize;\r\n      const bwdPaddingAverageSize = bwdPaddingAverageSizeItemsCount * fetch.averageItemSize;\r\n      const bwdPaddingAverageSizeDiff = _bwdPaddingAverageSize - bwdPaddingAverageSize;\r\n      const bwdAverageItemsSizeDiff = bwdAverageItemsCountDiff * fetch.averageItemSize;\r\n      const positionDiff = bwdPaddingAverageSizeDiff - bwdAverageItemsSizeDiff;\r\n      if (positionDiff) {\r\n        Adjust.setScroll(scroller, positionDiff);\r\n        scroller.logger.stat('after scroll position adjustment (average)');\r\n      }\r\n      state.bwdPaddingAverageSizeItemsCount = bwdPaddingAverageSizeItemsCount;\r\n    }\r\n\r\n    // if scrollable area size padding forward size have not been changed during this cycle\r\n    if (state.sizeBeforeRender === viewport.getScrollableSize() &&\r\n      viewport.paddings.forward.size === state.fwdPaddingBeforeRender) {\r\n      return;\r\n    }\r\n    // no negative area items\r\n    if (items[0].$index >= fetch.minIndex) {\r\n      return;\r\n    }\r\n\r\n    if (negativeSize > 0) {\r\n      Adjust.setScroll(scroller, negativeSize);\r\n    } else if (negativeSize < 0) {\r\n      viewport.paddings.forward.size -= negativeSize;\r\n      viewport.scrollPosition -= negativeSize;\r\n    }\r\n    scroller.logger.stat('after scroll position adjustment (negative)');\r\n  }\r\n\r\n  static setScroll(scroller: Scroller, delta: number) {\r\n    const { viewport } = scroller;\r\n    const forwardPadding = viewport.paddings[Direction.forward];\r\n    const oldPosition = viewport.scrollPosition;\r\n    const newPosition = Math.round(oldPosition + delta);\r\n    for (let i = 0; i < Adjust.MAX_SCROLL_ADJUSTMENTS_COUNT; i++) {\r\n      viewport.scrollPosition = newPosition;\r\n      const positionDiff = newPosition - viewport.scrollPosition;\r\n      if (positionDiff > 0) {\r\n        forwardPadding.size += positionDiff;\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import { Scroller } from '../scroller';\r\nimport { Direction, Process, ProcessStatus } from '../interfaces/index';\r\n\r\nexport default class Clip {\r\n\r\n  static run(scroller: Scroller) {\r\n    Clip.prepareClip(scroller);\r\n\r\n    if (scroller.state.clip) {\r\n      Clip.doClip(scroller);\r\n    }\r\n\r\n    scroller.callWorkflow({\r\n      process: Process.clip,\r\n      status: ProcessStatus.next\r\n    });\r\n  }\r\n\r\n  static prepareClip(scroller: Scroller) {\r\n    const { buffer, state, state: { fetch, fetch: { direction } } } = scroller;\r\n    if (!buffer.size) {\r\n      return;\r\n    }\r\n    if (state.isInitialWorkflowCycle && !state.scrollState.scroll) {\r\n      scroller.logger.log(`skipping clip [initial cycle, no scroll]`);\r\n      return;\r\n    }\r\n    const firstIndex = <number>fetch.firstIndexBuffer;\r\n    const lastIndex = <number>fetch.lastIndexBuffer;\r\n    scroller.logger.log(() =>\r\n      `looking for ${direction ? 'anti-' + direction + ' ' : ''}items ` +\r\n      `that are out of [${firstIndex}..${lastIndex}] range`);\r\n    if (!direction || direction === Direction.forward) {\r\n      if (firstIndex - 1 >= buffer.absMinIndex) {\r\n        Clip.prepareClipByDirection(scroller, Direction.forward, firstIndex);\r\n      }\r\n    }\r\n    if (!direction || direction === Direction.backward) {\r\n      if (lastIndex + 1 <= buffer.absMaxIndex) {\r\n        Clip.prepareClipByDirection(scroller, Direction.backward, lastIndex);\r\n      }\r\n    }\r\n    return;\r\n  }\r\n\r\n  static prepareClipByDirection(scroller: Scroller, direction: Direction, edgeIndex: number) {\r\n    const forward = direction === Direction.forward;\r\n    scroller.buffer.items.forEach(item => {\r\n      if (\r\n        (forward && item.$index < edgeIndex) ||\r\n        (!forward && item.$index > edgeIndex)\r\n      ) {\r\n        item.toRemove = true;\r\n        item.removeDirection = direction;\r\n        scroller.state.clip = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  static doClip(scroller: Scroller) {\r\n    const { buffer, viewport: { paddings }, logger } = scroller;\r\n    const clipped: Array<number> = [];\r\n    const size = { backward: 0, forward: 0 };\r\n    scroller.state.clipCall++;\r\n    logger.stat(`before clip (${scroller.state.clipCall})`);\r\n    buffer.items = buffer.items.filter(item => {\r\n      if (item.toRemove) {\r\n        size[item.removeDirection] += item.size;\r\n        item.hide();\r\n        clipped.push(item.$index);\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n    if (size.backward) {\r\n      paddings.forward.size += size.backward;\r\n    }\r\n    if (size.forward) {\r\n      paddings.backward.size += size.forward;\r\n    }\r\n    logger.log(() => [\r\n      `clipped ${clipped.length} items` +\r\n      (size.backward ? `, +${size.backward} fwd px,` : '') +\r\n      (size.forward ? `, +${size.forward} bwd px,` : ''),\r\n      `range: [${clipped[0]}..${clipped[clipped.length - 1]}]`\r\n    ]);\r\n    logger.stat('after clip');\r\n  }\r\n\r\n}\r\n","import { Scroller } from '../scroller';\nimport { Process, ProcessStatus, ProcessRun, Direction } from '../interfaces/index';\nimport { itemAdapterEmpty } from '../classes/adapter';\n\nexport default class End {\n\n  static run(scroller: Scroller, error?: any) {\n    // finalize current workflow loop\n    End.endWorkflowLoop(scroller);\n\n    // set out params, accessible via Adapter\n    End.calculateParams(scroller);\n\n    // what next? done?\n    const next = End.getNext(scroller, error);\n\n    // need to apply Buffer.items changes if clip\n    if (scroller.state.clip) {\n      scroller.runChangeDetector();\n    }\n\n    // stub method call\n    scroller.finalize();\n\n    // continue the Workflow synchronously; current cycle could be finilized immediately\n    scroller.callWorkflow({\n      process: Process.end,\n      status: next ? ProcessStatus.next : ProcessStatus.done,\n      payload: next || { empty: true }\n    });\n\n    // if the Workflow isn't finilized, it may freeze for no more than settings.throttle ms\n    if (scroller.state.workflowPending && !scroller.state.loopPending) {\n      // continue the Workflow asynchronously\n      End.continueWorkflowByTimer(scroller);\n    }\n  }\n\n  static endWorkflowLoop(scroller: Scroller) {\n    const { state } = scroller;\n    state.endLoop();\n    state.lastPosition = scroller.viewport.scrollPosition;\n    scroller.purgeInnerLoopSubscriptions();\n  }\n\n  static calculateParams(scroller: Scroller) {\n    const { items } = scroller.buffer;\n\n    // first visible item\n    if (scroller.state.firstVisibleWanted) {\n      const viewportBackwardEdge = scroller.viewport.getEdge(Direction.backward);\n      const firstItem = items.find(item =>\n        scroller.viewport.getElementEdge(item.element, Direction.forward) > viewportBackwardEdge\n      );\n      scroller.state.firstVisibleItem = firstItem ? {\n        $index: firstItem.$index,\n        data: firstItem.data,\n        element: firstItem.element\n      } : itemAdapterEmpty;\n    }\n\n    // last visible item\n    if (scroller.state.lastVisibleWanted) {\n      const viewportForwardEdge = scroller.viewport.getEdge(Direction.forward);\n      let lastItem = null;\n      for (let i = items.length - 1; i >= 0; i--) {\n        const edge = scroller.viewport.getElementEdge(items[i].element, Direction.backward);\n        if (edge < viewportForwardEdge) {\n          lastItem = items[i];\n          break;\n        }\n      }\n      scroller.state.lastVisibleItem = lastItem ? {\n        $index: lastItem.$index,\n        data: lastItem.data,\n        element: lastItem.element\n      } : itemAdapterEmpty;\n    }\n  }\n\n  static getNext(scroller: Scroller, error?: any): ProcessRun | null {\n    const { state: { fetch, scrollState } } = scroller;\n    let next: ProcessRun | null = null;\n    if (!error) {\n      if (fetch.hasNewItems) {\n        next = { scroll: false };\n      } else if (fetch.hasAnotherPack) {\n        next = { scroll: false };\n      }\n      if (scrollState.keepScroll) {\n        next = { scroll: true, keepScroll: true };\n      }\n    }\n    return next;\n  }\n\n  static continueWorkflowByTimer(scroller: Scroller) {\n    const { state, state: { workflowCycleCount, innerLoopCount } } = scroller;\n    scroller.logger.log(() => `setting Workflow timer (${workflowCycleCount}-${innerLoopCount})`);\n    state.scrollState.workflowTimer = <any>setTimeout(() => {\n      // if the WF isn't finilized while the old sub-cycle is done and there's no new sub-cycle\n      if (state.workflowPending && !state.loopPending && innerLoopCount === state.innerLoopCount) {\n        scroller.callWorkflow({\n          process: Process.end,\n          status: ProcessStatus.next,\n          payload: { scroll: true, byTimer: true }\n        });\n      }\n    }, scroller.settings.throttle);\n  }\n\n}\n","import { Subscription, BehaviorSubject } from 'rxjs';\n\nimport { UiScrollComponent } from '../ui-scroll.component';\nimport { Scroller } from './scroller';\nimport { Process, ProcessStatus as Status, ProcessSubject } from './interfaces/index';\nimport { Init, Scroll, Reload, Start, PreFetch, Fetch, PostFetch, Render, Clip, Adjust, End } from './processes/index';\n\nexport class Workflow {\n\n  scroller: Scroller;\n  process$: BehaviorSubject<ProcessSubject>;\n  cyclesDone: number;\n\n  readonly context: UiScrollComponent;\n  readonly onScrollHandler: EventListener;\n  private itemsSubscription: Subscription;\n  private workflowSubscription: Subscription;\n  private scrollEventOptions: any;\n\n  constructor(context: UiScrollComponent) {\n    this.context = context;\n    this.scroller = new Scroller(this.context, this.callWorkflow.bind(this));\n    this.process$ = new BehaviorSubject(<ProcessSubject>{\n      process: Process.init,\n      status: Status.start\n    });\n    this.cyclesDone = 0;\n    this.onScrollHandler = event => Scroll.run(this.scroller, { event });\n\n    if (this.scroller.settings.initializeDelay) {\n      setTimeout(() => this.init(), this.scroller.settings.initializeDelay);\n    } else {\n      this.init();\n    }\n  }\n\n  init() {\n    this.scroller.init();\n    this.scroller.logger.stat('initialization');\n    this.initListeners();\n  }\n\n  initListeners() {\n    const scroller = this.scroller;\n    scroller.logger.log(() => `uiScroll Workflow listeners are being initialized`);\n    this.itemsSubscription = scroller.buffer.$items.subscribe(items => this.context.items = items);\n    this.workflowSubscription = this.process$.subscribe(this.process.bind(this));\n    this.initScrollEventListener();\n  }\n\n  initScrollEventListener() {\n    let passiveSupported = false;\n    try {\n      window.addEventListener(\n        'test', <EventListenerOrEventListenerObject>{}, Object.defineProperty({}, 'passive', {\n          get: () => passiveSupported = true\n        })\n      );\n    } catch (err) {\n    }\n    this.scrollEventOptions = passiveSupported ? { passive: false } : false;\n    this.scroller.viewport.scrollEventElement.addEventListener(\n      'scroll', this.onScrollHandler, this.scrollEventOptions\n    );\n  }\n\n  detachScrollEventListener() {\n    this.scroller.viewport.scrollEventElement.removeEventListener(\n      'scroll', this.onScrollHandler, this.scrollEventOptions\n    );\n  }\n\n  process(data: ProcessSubject) {\n    const scroller = this.scroller;\n    const { status, payload } = data;\n    this.scroller.logger.logProcess(data);\n    if (status === Status.error) {\n      End.run(scroller, payload);\n      return;\n    }\n    switch (data.process) {\n      case Process.init:\n        if (status === Status.start) {\n          Init.run(scroller);\n        }\n        if (status === Status.next) {\n          Start.run(scroller, payload);\n        }\n        break;\n      case Process.reload:\n        if (status === Status.start) {\n          Reload.run(scroller, payload);\n        }\n        if (status === Status.next) {\n          Init.run(scroller);\n        }\n        break;\n      case Process.scroll:\n        if (status === Status.next) {\n          if (!(payload && payload.keepScroll)) {\n            Init.run(scroller, payload);\n          } else {\n            Start.run(scroller, payload);\n          }\n        }\n        break;\n      case Process.start:\n        if (status === Status.next) {\n          PreFetch.run(scroller);\n        }\n        break;\n      case Process.preFetch:\n        if (status === Status.done) {\n          End.run(scroller);\n        }\n        if (status === Status.next) {\n          Fetch.run(scroller);\n        }\n        break;\n      case Process.fetch:\n        if (status === Status.next) {\n          PostFetch.run(scroller);\n        }\n        break;\n      case Process.postFetch:\n        if (status === Status.next) {\n          Render.run(scroller);\n        }\n        if (status === Status.done) {\n          End.run(scroller);\n        }\n        break;\n      case Process.render:\n        if (status === Status.next) {\n          if (scroller.settings.infinite) {\n            Adjust.run(scroller);\n          } else {\n            Clip.run(scroller);\n          }\n        }\n        break;\n      case Process.clip:\n        if (status === Status.next) {\n          Adjust.run(scroller);\n        }\n        break;\n      case Process.adjust:\n        if (status === Status.done) {\n          End.run(scroller);\n        }\n        break;\n      case Process.end:\n        if (status === Status.next) {\n          if (payload && payload.keepScroll) {\n            Scroll.run(scroller);\n          } else {\n            Start.run(scroller, payload);\n          }\n        }\n        if (status === Status.done) {\n          this.done();\n        }\n        break;\n    }\n  }\n\n  callWorkflow(processSubject: ProcessSubject) {\n    this.process$.next(processSubject);\n  }\n\n  done() {\n    const { state } = this.scroller;\n    this.cyclesDone++;\n    state.workflowCycleCount = this.cyclesDone + 1;\n    state.isInitialWorkflowCycle = false;\n    state.workflowPending = false;\n    if (state.scrollState.scrollTimer === null) {\n      state.isLoading = false;\n    }\n    this.finalize();\n  }\n\n  dispose() {\n    this.detachScrollEventListener();\n    this.process$.complete();\n    this.workflowSubscription.unsubscribe();\n    this.itemsSubscription.unsubscribe();\n    this.scroller.dispose();\n  }\n\n  finalize() {\n  }\n\n}\n","import {\n  Component, OnInit, OnDestroy,\n  TemplateRef, ElementRef,\n  ChangeDetectionStrategy, ChangeDetectorRef\n} from '@angular/core';\n\nimport { Workflow } from './component/workflow';\nimport { Datasource as IDatasource } from './component/interfaces/index';\nimport { Datasource } from './component/classes/datasource';\nimport { Item } from './component/classes/item';\n\n@Component({\n  selector: '[ui-scroll]',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `<div data-padding-backward></div><div\n  *ngFor=\"let item of items\"\n  [attr.data-sid]=\"item.nodeId\"\n  [style.position]=\"item.invisible ? 'fixed' : null\"\n  [style.left]=\"item.invisible ? '-99999px' : null\"\n><ng-template\n  [ngTemplateOutlet]=\"template\"\n  [ngTemplateOutletContext]=\"{\n    $implicit: item.data,\n    index: item.$index,\n    odd: item.$index % 2,\n    even: !(item.$index % 2)\n }\"\n></ng-template></div><div data-padding-forward></div>`\n})\nexport class UiScrollComponent implements OnInit, OnDestroy {\n\n  // come from the directive\n  public version: string;\n  public template: TemplateRef<any>;\n  public datasource: IDatasource | Datasource;\n\n  // use in the template\n  public items: Array<Item>;\n\n  // Component-Workflow integration\n  public workflow: Workflow;\n\n  constructor(\n    public changeDetector: ChangeDetectorRef,\n    public elementRef: ElementRef\n  ) {\n  }\n\n  ngOnInit() {\n    this.workflow = new Workflow(this);\n  }\n\n  ngOnDestroy() {\n    this.workflow.dispose();\n  }\n}\n","export default '1.0.1';\n","import { Directive, Input, TemplateRef, ViewContainerRef, ComponentFactoryResolver, OnInit } from '@angular/core';\n\nimport version from './ui-scroll.version';\nimport { UiScrollComponent } from './ui-scroll.component';\nimport { Datasource } from './component/interfaces/datasource';\n\n@Directive({ selector: '[uiScroll][uiScrollOf]' })\nexport class UiScrollDirective implements OnInit {\n  private version: string;\n  private datasource: Datasource;\n\n  constructor(\n    private templateRef: TemplateRef<any>,\n    private viewContainer: ViewContainerRef,\n    private resolver: ComponentFactoryResolver\n  ) {\n  }\n\n  @Input() set uiScrollOf(datasource: Datasource) {\n    this.datasource = datasource;\n  }\n\n  ngOnInit() {\n    const templateView = this.templateRef.createEmbeddedView({});\n    const compFactory = this.resolver.resolveComponentFactory(UiScrollComponent);\n    const componentRef = this.viewContainer.createComponent(\n      compFactory, undefined, this.viewContainer.injector, [templateView.rootNodes]\n    );\n    componentRef.instance.datasource = this.datasource;\n    componentRef.instance.template = this.templateRef;\n    componentRef.instance.version = version;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UiScrollComponent } from './ui-scroll.component';\nimport { UiScrollDirective } from './ui-scroll.directive';\n\n@NgModule({\n  declarations: [\n    UiScrollComponent,\n    UiScrollDirective\n  ],\n  imports: [CommonModule],\n  entryComponents: [UiScrollComponent],\n  exports: [UiScrollDirective],\n  providers: []\n})\nexport class UiScrollModule { }\n"],"names":["Observable","switchMap","observableOf","BehaviorSubject","Status","Component","ChangeDetectionStrategy","ChangeDetectorRef","ElementRef","Directive","TemplateRef","ViewContainerRef","ComponentFactoryResolver","Input","NgModule","CommonModule"],"mappings":"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"}